<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.552">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Website - Yelp Reviews NLP Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Website</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../projects.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../visualization.html"> 
<span class="menu-text">Visualization</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#import-libraries" id="toc-import-libraries" class="nav-link active" data-scroll-target="#import-libraries">Import Libraries</a></li>
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation">Data Preparation</a>
  <ul class="collapse">
  <li><a href="#eda" id="toc-eda" class="nav-link" data-scroll-target="#eda">EDA</a></li>
  </ul></li>
  <li><a href="#text-preprocessing" id="toc-text-preprocessing" class="nav-link" data-scroll-target="#text-preprocessing">Text Preprocessing</a></li>
  <li><a href="#word-frequency-analysis" id="toc-word-frequency-analysis" class="nav-link" data-scroll-target="#word-frequency-analysis">Word Frequency Analysis</a></li>
  <li><a href="#sentiment-analysis" id="toc-sentiment-analysis" class="nav-link" data-scroll-target="#sentiment-analysis">Sentiment Analysis</a>
  <ul class="collapse">
  <li><a href="#textblob." id="toc-textblob." class="nav-link" data-scroll-target="#textblob.">1 TextBlob.</a></li>
  <li><a href="#vader" id="toc-vader" class="nav-link" data-scroll-target="#vader">2. VADER</a></li>
  <li><a href="#compare-accuracy-of-both-vader-and-texrblob" id="toc-compare-accuracy-of-both-vader-and-texrblob" class="nav-link" data-scroll-target="#compare-accuracy-of-both-vader-and-texrblob">Compare Accuracy of both VADER and TexrBlob</a></li>
  </ul></li>
  <li><a href="#top-modeling-with-lda" id="toc-top-modeling-with-lda" class="nav-link" data-scroll-target="#top-modeling-with-lda">Top Modeling with LDA</a>
  <ul class="collapse">
  <li><a href="#preprocessing-for-topic-modeling" id="toc-preprocessing-for-topic-modeling" class="nav-link" data-scroll-target="#preprocessing-for-topic-modeling">Preprocessing for Topic Modeling</a></li>
  <li><a href="#topic-modeling-for-positive-reviews" id="toc-topic-modeling-for-positive-reviews" class="nav-link" data-scroll-target="#topic-modeling-for-positive-reviews">Topic Modeling for Positive Reviews</a></li>
  <li><a href="#topic-modeling-for-negative-reviews" id="toc-topic-modeling-for-negative-reviews" class="nav-link" data-scroll-target="#topic-modeling-for-negative-reviews">Topic Modeling for Negative Reviews</a></li>
  </ul></li>
  <li><a href="#dimensionality-reduction-with-pca" id="toc-dimensionality-reduction-with-pca" class="nav-link" data-scroll-target="#dimensionality-reduction-with-pca">Dimensionality Reduction with PCA</a>
  <ul class="collapse">
  <li><a href="#positive-reviews-2" id="toc-positive-reviews-2" class="nav-link" data-scroll-target="#positive-reviews-2">Positive Reviews</a></li>
  <li><a href="#negative-reviews-2" id="toc-negative-reviews-2" class="nav-link" data-scroll-target="#negative-reviews-2">Negative Reviews</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Yelp Reviews NLP Analysis</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>This notebook performs a basic NLP analysis on Yelp reviews data. The analysis includes text preprocessing, word frequency analysis, and sentiment analysis using the NLTK and TextBlob packages then compare the results with Vader package.</p>
<section id="import-libraries" class="level2">
<h2 class="anchored" data-anchor-id="import-libraries">Import Libraries</h2>
<p>First, we import the necessary libraries for our analysis.</p>
<div id="45cda815" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> Counter</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> nltk</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.corpus <span class="im">import</span> stopwords</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.tokenize <span class="im">import</span> word_tokenize</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.stem <span class="im">import</span> WordNetLemmatizer</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> textblob <span class="im">import</span> TextBlob</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> gensim.models <span class="im">import</span> Word2Vec</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.decomposition <span class="im">import</span> PCA</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> wordcloud <span class="im">import</span> WordCloud</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> networkx <span class="im">as</span> nx</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> multiprocessing</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.sentiment.vader <span class="im">import</span> SentimentIntensityAnalyzer</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Download necessary NLTK data</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>nltk.download(<span class="st">'punkt'</span>)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>nltk.download(<span class="st">'stopwords'</span>)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>nltk.download(<span class="st">'wordnet'</span>)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>nltk.download(<span class="st">'omw-1.4'</span>)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>nltk.download(<span class="st">'vader_lexicon'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>[nltk_data] Downloading package punkt to /Users/duyentran/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package stopwords to
[nltk_data]     /Users/duyentran/nltk_data...
[nltk_data]   Package stopwords is already up-to-date!
[nltk_data] Downloading package wordnet to
[nltk_data]     /Users/duyentran/nltk_data...
[nltk_data]   Package wordnet is already up-to-date!
[nltk_data] Downloading package omw-1.4 to
[nltk_data]     /Users/duyentran/nltk_data...
[nltk_data]   Package omw-1.4 is already up-to-date!
[nltk_data] Downloading package vader_lexicon to
[nltk_data]     /Users/duyentran/nltk_data...
[nltk_data]   Package vader_lexicon is already up-to-date!</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>True</code></pre>
</div>
</div>
<div id="41445a2e" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the dataset</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>file_path <span class="op">=</span> <span class="st">'yelp.csv'</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>yelp_df <span class="op">=</span> pd.read_csv(file_path)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>yelp_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">business_id</th>
<th data-quarto-table-cell-role="th">date</th>
<th data-quarto-table-cell-role="th">review_id</th>
<th data-quarto-table-cell-role="th">stars</th>
<th data-quarto-table-cell-role="th">text</th>
<th data-quarto-table-cell-role="th">type</th>
<th data-quarto-table-cell-role="th">user_id</th>
<th data-quarto-table-cell-role="th">cool</th>
<th data-quarto-table-cell-role="th">useful</th>
<th data-quarto-table-cell-role="th">funny</th>
<th data-quarto-table-cell-role="th">text_length</th>
<th data-quarto-table-cell-role="th">tokens</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>9yKzy9PApeiPPOUJEtnvkg</td>
<td>2011-01-26</td>
<td>fWKvX83p0-ka4JS3dc6E5A</td>
<td>5</td>
<td>My wife took me here on my birthday for breakf...</td>
<td>review</td>
<td>rLtl8ZkDX5vH5nAx9C3q5Q</td>
<td>2</td>
<td>5</td>
<td>0</td>
<td>889</td>
<td>['wife', 'took', 'birthday', 'breakfast', 'exc...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>ZRJwVLyzEJq1VAihDhYiow</td>
<td>2011-07-27</td>
<td>IjZ33sJrzXqU-0X6U8NwyA</td>
<td>5</td>
<td>I have no idea why some people give bad review...</td>
<td>review</td>
<td>0a2KyEL0d3Yb1V6aivbIuQ</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1345</td>
<td>['idea', 'people', 'give', 'bad', 'reviews', '...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>6oRAC4uyJCsJl1X0WZpVSA</td>
<td>2012-06-14</td>
<td>IESLBzqUCLdSzSqm0eCSxQ</td>
<td>4</td>
<td>love the gyro plate. Rice is so good and I als...</td>
<td>review</td>
<td>0hT2KtfLiobPvh6cDC8JQg</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>76</td>
<td>['love', 'gyro', 'plate', 'rice', 'good', 'als...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>_1QQZuf4zZOyFCvXc0o6Vg</td>
<td>2010-05-27</td>
<td>G-WvGaISbqqaMHlNnByodA</td>
<td>5</td>
<td>Rosie, Dakota, and I LOVE Chaparral Dog Park!!...</td>
<td>review</td>
<td>uZetl9T0NcROGOyFfughhg</td>
<td>1</td>
<td>2</td>
<td>0</td>
<td>419</td>
<td>['rosie', 'dakota', 'love', 'chaparral', 'dog'...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>6ozycU1RpktNG2-1BroVtw</td>
<td>2012-01-05</td>
<td>1uJFq2r5QfJG_6ExMRCaGw</td>
<td>5</td>
<td>General Manager Scott Petello is a good egg!!!...</td>
<td>review</td>
<td>vYmM4KTsC8ZfQBg-j5MWkw</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>469</td>
<td>['general', 'manager', 'scott', 'petello', 'go...</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</section>
<section id="data-preparation" class="level2">
<h2 class="anchored" data-anchor-id="data-preparation">Data Preparation</h2>
<div id="72d72d27" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>yelp_df.dtypes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>business_id    object
date           object
review_id      object
stars           int64
text           object
type           object
user_id        object
cool            int64
useful          int64
funny           int64
text_length     int64
tokens         object
dtype: object</code></pre>
</div>
</div>
<div id="ead78a3c" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>yelp_stats <span class="op">=</span> pd.DataFrame(yelp_df.count(),columns<span class="op">=</span>[<span class="st">'count'</span>])</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>yelp_stats[<span class="st">'isna'</span>] <span class="op">=</span> yelp_df.isna().<span class="bu">sum</span>()</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>yelp_stats[<span class="st">'% pop'</span>] <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> yelp_df.isna().<span class="bu">sum</span>()<span class="op">/</span><span class="bu">len</span>(yelp_df)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>yelp_stats</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">isna</th>
<th data-quarto-table-cell-role="th">% pop</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">business_id</td>
<td>4000</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">date</td>
<td>4000</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">review_id</td>
<td>4000</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">stars</td>
<td>4000</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">text</td>
<td>4000</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">type</td>
<td>4000</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">user_id</td>
<td>4000</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">cool</td>
<td>4000</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">useful</td>
<td>4000</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">funny</td>
<td>4000</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">text_length</td>
<td>4000</td>
<td>0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">tokens</td>
<td>4000</td>
<td>0</td>
<td>1.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div id="b8ee22a1" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>yelp_df.describe(include <span class="op">=</span> <span class="st">'all'</span>).transpose()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">unique</th>
<th data-quarto-table-cell-role="th">top</th>
<th data-quarto-table-cell-role="th">freq</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">min</th>
<th data-quarto-table-cell-role="th">25%</th>
<th data-quarto-table-cell-role="th">50%</th>
<th data-quarto-table-cell-role="th">75%</th>
<th data-quarto-table-cell-role="th">max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">business_id</td>
<td>4000</td>
<td>2366</td>
<td>V1nEpIRmEa1768oj_tuxeQ</td>
<td>18</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">date</td>
<td>4000</td>
<td>1597</td>
<td>2011-03-28</td>
<td>11</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">review_id</td>
<td>4000</td>
<td>4000</td>
<td>fWKvX83p0-ka4JS3dc6E5A</td>
<td>1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">stars</td>
<td>4000.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>3.78075</td>
<td>1.21575</td>
<td>1.0</td>
<td>3.0</td>
<td>4.0</td>
<td>5.0</td>
<td>5.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">text</td>
<td>4000</td>
<td>3999</td>
<td>Great service</td>
<td>2</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">type</td>
<td>4000</td>
<td>1</td>
<td>review</td>
<td>4000</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">user_id</td>
<td>4000</td>
<td>3050</td>
<td>fczQCSmaWF78toLEmb0Zsw</td>
<td>18</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">cool</td>
<td>4000.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.8925</td>
<td>1.956247</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>28.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">useful</td>
<td>4000.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1.41725</td>
<td>2.23817</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>2.0</td>
<td>28.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">funny</td>
<td>4000.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.74175</td>
<td>1.972316</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>39.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">text_length</td>
<td>4000.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>702.56675</td>
<td>608.449521</td>
<td>6.0</td>
<td>294.0</td>
<td>531.5</td>
<td>928.0</td>
<td>4997.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">tokens</td>
<td>4000</td>
<td>3999</td>
<td>['great', 'service']</td>
<td>2</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div id="b3fa3263" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_zeros(data):</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> data:</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> i <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>            count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> count</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>numerics <span class="op">=</span> [<span class="st">'date'</span>,<span class="st">'stars'</span>, <span class="st">'cool'</span>, <span class="st">'useful'</span>, <span class="st">'funny'</span>]</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>categoricals <span class="op">=</span> [<span class="st">'business_id'</span>, <span class="st">'review_id'</span>, <span class="st">'text'</span>,<span class="st">'type'</span>, <span class="st">'user_id'</span>]</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>statistics_of_data1 <span class="op">=</span> []</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> numerics:</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    num_zeros <span class="op">=</span> count_zeros(yelp_df[col])</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    percent_zeros <span class="op">=</span> num_zeros <span class="op">/</span> yelp_df.shape[<span class="dv">0</span>] <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> pd.api.types.is_numeric_dtype(yelp_df[col]):</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>        min_val <span class="op">=</span> <span class="bu">round</span>(yelp_df[col].<span class="bu">min</span>(), <span class="dv">2</span>)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>        max_val <span class="op">=</span> <span class="bu">round</span>(yelp_df[col].<span class="bu">max</span>(), <span class="dv">2</span>)</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>        mean_val <span class="op">=</span> yelp_df[col].mean()</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>        std_val <span class="op">=</span> <span class="bu">round</span>(np.std(yelp_df[col]), <span class="dv">2</span>)</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>        min_val <span class="op">=</span> max_val <span class="op">=</span> mean_val <span class="op">=</span> std_val <span class="op">=</span> <span class="va">None</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>    statistics_of_data1.append((col,</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'numeric'</span>,</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>                                yelp_df[col].notnull().<span class="bu">sum</span>(),</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>                                <span class="ss">f'</span><span class="sc">{</span>yelp_df[col]<span class="sc">.</span>notnull()<span class="sc">.</span><span class="bu">sum</span>()<span class="op">/</span>yelp_df<span class="sc">.</span>shape[<span class="dv">0</span>]<span class="op">*</span><span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">%'</span>,</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>                                count_zeros(yelp_df[col]),</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>                                min_val,</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>                                max_val,</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>                                mean_val,</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>                                std_val,</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>                                yelp_df[col].mode()[<span class="dv">0</span>]</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>                                ))</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>stats_dfnum <span class="op">=</span> pd.DataFrame(statistics_of_data1, columns <span class="op">=</span> [<span class="st">'Field Name'</span>, <span class="st">'Field Type'</span>,<span class="st">'# Records Have Values'</span>, <span class="st">'% Populated'</span>, <span class="st">'# Zeros'</span>, <span class="st">'Min'</span>, <span class="st">'Max'</span>, <span class="st">'Mean'</span>, <span class="st">'Standard Deviation'</span>, <span class="st">'Most Common'</span>])</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>stats_dfnum</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Field Name</th>
<th data-quarto-table-cell-role="th">Field Type</th>
<th data-quarto-table-cell-role="th"># Records Have Values</th>
<th data-quarto-table-cell-role="th">% Populated</th>
<th data-quarto-table-cell-role="th"># Zeros</th>
<th data-quarto-table-cell-role="th">Min</th>
<th data-quarto-table-cell-role="th">Max</th>
<th data-quarto-table-cell-role="th">Mean</th>
<th data-quarto-table-cell-role="th">Standard Deviation</th>
<th data-quarto-table-cell-role="th">Most Common</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>date</td>
<td>numeric</td>
<td>4000</td>
<td>100.0%</td>
<td>0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2011-03-28</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>stars</td>
<td>numeric</td>
<td>4000</td>
<td>100.0%</td>
<td>0</td>
<td>1.0</td>
<td>5.0</td>
<td>3.78075</td>
<td>1.22</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>cool</td>
<td>numeric</td>
<td>4000</td>
<td>100.0%</td>
<td>2508</td>
<td>0.0</td>
<td>28.0</td>
<td>0.89250</td>
<td>1.96</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>useful</td>
<td>numeric</td>
<td>4000</td>
<td>100.0%</td>
<td>1656</td>
<td>0.0</td>
<td>28.0</td>
<td>1.41725</td>
<td>2.24</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>funny</td>
<td>numeric</td>
<td>4000</td>
<td>100.0%</td>
<td>2773</td>
<td>0.0</td>
<td>39.0</td>
<td>0.74175</td>
<td>1.97</td>
<td>0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div id="82909590" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>statistics_of_data <span class="op">=</span> []</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> categoricals:</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    statistics_of_data.append((col,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>                             <span class="st">'categorical'</span>,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>                             yelp_df[col].notnull().<span class="bu">sum</span>(),</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>                             <span class="ss">f'</span><span class="sc">{</span>yelp_df[col]<span class="sc">.</span>notnull()<span class="sc">.</span><span class="bu">sum</span>()<span class="op">/</span>yelp_df<span class="sc">.</span>shape[<span class="dv">0</span>]<span class="op">*</span><span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">%'</span>,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>                             count_zeros(yelp_df[col]),</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>                             yelp_df[col].nunique(),</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>                             yelp_df[col].mode()[<span class="dv">0</span>]</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>                            </span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>                             ))</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>stats_dfcat <span class="op">=</span> pd.DataFrame(statistics_of_data, columns <span class="op">=</span> [<span class="st">'Field Name'</span>, <span class="st">'Field Type'</span>,<span class="st">'# Records Have Values'</span>, <span class="st">'% Populated'</span>, <span class="st">'# Zeros'</span>,<span class="st">'# Unique Values'</span>, <span class="st">'Most Common'</span>,])</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>stats_dfcat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Field Name</th>
<th data-quarto-table-cell-role="th">Field Type</th>
<th data-quarto-table-cell-role="th"># Records Have Values</th>
<th data-quarto-table-cell-role="th">% Populated</th>
<th data-quarto-table-cell-role="th"># Zeros</th>
<th data-quarto-table-cell-role="th"># Unique Values</th>
<th data-quarto-table-cell-role="th">Most Common</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>business_id</td>
<td>categorical</td>
<td>4000</td>
<td>100.0%</td>
<td>0</td>
<td>2366</td>
<td>V1nEpIRmEa1768oj_tuxeQ</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>review_id</td>
<td>categorical</td>
<td>4000</td>
<td>100.0%</td>
<td>0</td>
<td>4000</td>
<td>--DazeDpOApabZnIOIPSrQ</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>text</td>
<td>categorical</td>
<td>4000</td>
<td>100.0%</td>
<td>0</td>
<td>3999</td>
<td>Great service</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>type</td>
<td>categorical</td>
<td>4000</td>
<td>100.0%</td>
<td>0</td>
<td>1</td>
<td>review</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>user_id</td>
<td>categorical</td>
<td>4000</td>
<td>100.0%</td>
<td>0</td>
<td>3050</td>
<td>fczQCSmaWF78toLEmb0Zsw</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>Check out the full version of Data Quality Report here: (UCSD only)</p>
<p>https://docs.google.com/document/d/1ZR3nWFwd22BlWZ_fuy1P_Qn1lHNDMKP9PdH0xeeXMmE/edit?usp=sharing</p>
<section id="eda" class="level3">
<h3 class="anchored" data-anchor-id="eda">EDA</h3>
<div id="4f50c5ce" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>yelp_df[<span class="st">'text_length'</span>] <span class="op">=</span> yelp_df[<span class="st">'text'</span>].<span class="bu">apply</span>(<span class="bu">len</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="abb46e38" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>(style<span class="op">=</span><span class="st">"white"</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> sns.FacetGrid(yelp_df, col<span class="op">=</span><span class="st">"stars"</span>, sharey<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>g.<span class="bu">map</span>(plt.hist, <span class="st">'text_length'</span>, bins<span class="op">=</span><span class="dv">30</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-10-output-1.png" width="1425" height="271" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>All histograms show a right-skewed distribution, indicating that the most reviews are relatively short, with fewer long reviews. The peak text length decreases as the star rating increase, which means the peak of 1-star reviews is at a lower text length and the peak of 5-star reviews is at a slightly higher text length compared to lower ratings.</p>
<p>The higher star ratings tend to have slightly longer reviews, this might suggest that users who are very satiisfied with their experence are more likely to write detailed reviews</p>
<div id="a618f286" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the countplot</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>sns.countplot(x<span class="op">=</span><span class="st">'stars'</span>, data<span class="op">=</span>yelp_df)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-11-output-1.png" width="605" height="435" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="dc66935c" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>yelp_df.dtypes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>business_id    object
date           object
review_id      object
stars           int64
text           object
type           object
user_id        object
cool            int64
useful          int64
funny           int64
text_length     int64
tokens         object
dtype: object</code></pre>
</div>
</div>
</section>
</section>
<section id="text-preprocessing" class="level2">
<h2 class="anchored" data-anchor-id="text-preprocessing">Text Preprocessing</h2>
<p>Define a function to preprocess the text by steps:</p>
<ul>
<li><p>Remove html tags: Clean up the text by removing any HTML markup</p></li>
<li><p>Remove non-alphabet characters: Ensure that the text contains only alphabetic characters, removing numbers and punctuation.</p></li>
<li><p>Tokenize the text: Split the text into individual words and convert to lower case</p></li>
<li><p>Remove stopwords: Filter out common words that do not add significant meaning.</p></li>
</ul>
<div id="4ed5c282" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-07-04T21:52:41.796400100Z&quot;,&quot;start_time&quot;:&quot;2024-07-04T21:52:32.905308800Z&quot;}" data-execution_count="12">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a function to preprocess the text</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> preprocess_text(text):</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove HTML tags</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> re.sub(<span class="vs">r'&lt;.*?&gt;'</span>, <span class="st">''</span>, text)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove non-alphabet characters</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> re.sub(<span class="vs">r'[^a-zA-Z]'</span>, <span class="st">' '</span>, text)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Tokenize the text</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    tokens <span class="op">=</span> word_tokenize(text.lower())</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove stopwords</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    stop_words <span class="op">=</span> <span class="bu">set</span>(stopwords.words(<span class="st">'english'</span>))</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    filtered_tokens <span class="op">=</span> [word <span class="cf">for</span> word <span class="kw">in</span> tokens <span class="cf">if</span> word.isalnum() <span class="kw">and</span> word <span class="kw">not</span> <span class="kw">in</span> stop_words]</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> filtered_tokens</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply preprocessing to all reviews</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>yelp_df[<span class="st">'tokens'</span>] <span class="op">=</span> yelp_df[<span class="st">'text'</span>].<span class="bu">apply</span>(preprocess_text)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="a5d89aa6" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>yelp_df[<span class="st">'tokens'</span>].head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>0    [wife, took, birthday, breakfast, excellent, w...
1    [idea, people, give, bad, reviews, place, goes...
2    [love, gyro, plate, rice, good, also, dig, can...
3    [rosie, dakota, love, chaparral, dog, park, co...
4    [general, manager, scott, petello, good, egg, ...
Name: tokens, dtype: object</code></pre>
</div>
</div>
</section>
<section id="word-frequency-analysis" class="level2">
<h2 class="anchored" data-anchor-id="word-frequency-analysis">Word Frequency Analysis</h2>
<p>Perform a frequency analysis to find the most common words in the reviews.</p>
<div id="e609e238" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-07-04T21:52:41.951888Z&quot;,&quot;start_time&quot;:&quot;2024-07-04T21:52:41.774461300Z&quot;}" data-execution_count="14">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Flatten the list of tokens for frequency analysis</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>all_tokens <span class="op">=</span> [token <span class="cf">for</span> tokens <span class="kw">in</span> yelp_df[<span class="st">'tokens'</span>] <span class="cf">for</span> token <span class="kw">in</span> tokens]</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>freq_dist <span class="op">=</span> Counter(all_tokens)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the top 10 most common words</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>common_words <span class="op">=</span> freq_dist.most_common(<span class="dv">20</span>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(common_words)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[('good', 2639), ('place', 2540), ('food', 2375), ('great', 2042), ('like', 1983), ('one', 1635), ('get', 1540), ('go', 1410), ('really', 1345), ('time', 1312), ('service', 1287), ('would', 1202), ('back', 1192), ('also', 1000), ('love', 897), ('nice', 897), ('little', 874), ('well', 830), ('best', 778), ('always', 778)]</code></pre>
</div>
</div>
<p>Notice that words that are frequent in the context of reviews but donâ€™t carry a strong sentiment themselves such as: â€œfoodâ€, â€œplaceâ€, â€œserviceâ€,â€œrestaurantâ€â€¦and some stop words in the common words list such as: â€œusâ€, â€œalwaysâ€, â€œalsoâ€, â€œevenâ€â€¦ still havenâ€™t been filtered out.These could lead to the incorrect sentiment analysis (e.g: the common words of positive and negative review are the same). So letâ€™s refind the process</p>
<div id="02dc659f" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a function to preprocess the text</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> preprocess_text(text):</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove HTML tags</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> re.sub(<span class="vs">r'&lt;.*?&gt;'</span>, <span class="st">''</span>, text)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove non-alphabet characters</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> re.sub(<span class="vs">r'[^a-zA-Z]'</span>, <span class="st">' '</span>, text)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Tokenize the text</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    tokens <span class="op">=</span> word_tokenize(text.lower())</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove stopwords</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>    stop_words <span class="op">=</span> <span class="bu">set</span>(stopwords.words(<span class="st">'english'</span>)).union({<span class="st">'food'</span>, <span class="st">'service'</span>, <span class="st">'place'</span>, <span class="st">'restaurant'</span>, <span class="st">'us'</span>, <span class="st">'always'</span>, <span class="st">'even'</span>, <span class="st">'little'</span>, <span class="st">'also'</span>, <span class="st">'really'</span>,<span class="st">'would'</span>})</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>    lemmatizer <span class="op">=</span> WordNetLemmatizer()</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>    filtered_tokens <span class="op">=</span> [lemmatizer.lemmatize(word) <span class="cf">for</span> word <span class="kw">in</span> tokens <span class="cf">if</span> word.isalnum() <span class="kw">and</span> word <span class="kw">not</span> <span class="kw">in</span> stop_words]</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> filtered_tokens</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply preprocessing to all reviews</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>yelp_df[<span class="st">'tokens'</span>] <span class="op">=</span> yelp_df[<span class="st">'text'</span>].<span class="bu">apply</span>(preprocess_text)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="a97a619e" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Flatten the list of tokens for frequency analysis</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>all_tokens <span class="op">=</span> [token <span class="cf">for</span> tokens <span class="kw">in</span> yelp_df[<span class="st">'tokens'</span>] <span class="cf">for</span> token <span class="kw">in</span> tokens]</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>freq_dist <span class="op">=</span> Counter(all_tokens)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the top 10 most common words</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>common_words <span class="op">=</span> freq_dist.most_common(<span class="dv">20</span>)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(common_words)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[('good', 2657), ('great', 2042), ('like', 2007), ('time', 1749), ('one', 1736), ('get', 1658), ('go', 1488), ('back', 1196), ('love', 937), ('nice', 897), ('well', 831), ('make', 812), ('best', 778), ('got', 758), ('thing', 721), ('pretty', 719), ('know', 718), ('try', 716), ('much', 706), ('chicken', 703)]</code></pre>
</div>
</div>
<div id="5b416248" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>wordcloud <span class="op">=</span> WordCloud(width<span class="op">=</span><span class="dv">800</span>, height<span class="op">=</span><span class="dv">400</span>, background_color<span class="op">=</span><span class="st">'white'</span>).generate_from_frequencies(freq_dist)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the word cloud</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>plt.imshow(wordcloud, interpolation<span class="op">=</span><span class="st">'bilinear'</span>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Word Cloud in data'</span>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-18-output-1.png" width="758" height="408" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="sentiment-analysis" class="level2">
<h2 class="anchored" data-anchor-id="sentiment-analysis">Sentiment Analysis</h2>
<section id="textblob." class="level3">
<h3 class="anchored" data-anchor-id="textblob.">1 TextBlob.</h3>
<section id="perform-sentiment-analysis-on-the-reviews" class="level4">
<h4 class="anchored" data-anchor-id="perform-sentiment-analysis-on-the-reviews">1.1 Perform sentiment analysis on the reviews</h4>
<p>TextBlobâ€™s sentiment analysis is based on the Pattern library and uses a combination of NLP techniques to determine the sentiment polarity and subjectivity.</p>
<p>Polarity determines the sentiment of text. Its values lie in [-1, 1] where -1 denotes the highly negative sentiment and 1 denotes a highly positive sentiment.</p>
<p>How TextBlob calculates sentiment score:</p>
<ol type="1">
<li><p>Tokenization: The text is split into individual words, which we have done in the text preprocessing</p></li>
<li><p>Lexicon Lookup: Each token is looked up in the sentiment lexicon to find its associated polarity and subjectivity scores.</p></li>
<li><p>Score Aggregation: The polarity scores of individual words are aggregated to compute the overall polarity score of the text. This is usually done by averaging the scores.</p></li>
</ol>
<div id="eeb58180" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-07-04T21:52:48.106705200Z&quot;,&quot;start_time&quot;:&quot;2024-07-04T21:52:41.888566200Z&quot;}" data-execution_count="18">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform sentiment analysis using TextBlob</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>yelp_df[<span class="st">'textblob_score'</span>] <span class="op">=</span> yelp_df[<span class="st">'text'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: TextBlob(x).sentiment.polarity)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="a16fe8fc" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-07-04T21:52:48.255446500Z&quot;,&quot;start_time&quot;:&quot;2024-07-04T21:52:48.052845500Z&quot;}" data-execution_count="19">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the sentiment analysis</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>plt.hist(yelp_df[<span class="st">'textblob_score'</span>], bins<span class="op">=</span><span class="dv">20</span>, color<span class="op">=</span><span class="st">'skyblue'</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Sentiment Analysis of Yelp Reviews'</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Sentiment Score'</span>)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Frequency'</span>)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-20-output-1.png" width="820" height="529" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>This distribution is approximately bell-shaped and symmetric, centered around a positive sentiment score. The histogram is skewed towards the positive sidem indicating the most reviews have a slightly positive sentiment. This align with the stars distribution above where the majority of reviews are 4 and 5 stars.</p>
<p>The predominance of mildly positive sentiment (around 0.25) suggests that while most customers are happy, there is still room for improvement to convert these mildly positive experiences into very positive ones.</p>
</section>
<section id="compare-sentiment-with-star-ratings" class="level4">
<h4 class="anchored" data-anchor-id="compare-sentiment-with-star-ratings">1.2 Compare Sentiment with Star Ratings</h4>
<p>Compare sentiment scores with star ratings to see if there is a correlation.</p>
<div id="17d9b5f7" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-07-04T21:52:48.612618600Z&quot;,&quot;start_time&quot;:&quot;2024-07-04T21:52:48.186749100Z&quot;}" data-execution_count="20">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a scatter plot to compare star ratings with sentiment scores</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>plt.scatter(yelp_df[<span class="st">'stars'</span>], yelp_df[<span class="st">'textblob_score'</span>], alpha<span class="op">=</span><span class="fl">0.5</span>, color<span class="op">=</span><span class="st">'blue'</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Comparison of Star Ratings and Sentiment Scores'</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Star Ratings'</span>)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Sentiment Score'</span>)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-21-output-1.png" width="833" height="529" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>While 4 and 5 star reviews has high concentration of positive sentiment score, typically around 0.6 to 1 and itâ€™s overwhelmingly positive as expected for 4 and 5 stars, the 1 star reviews show a wide range of sentiment scores. In another word, while most 1-star reviews are expectedly negative, there are some instances where the text may not be purely negative.</p>
</section>
<section id="positive-reviews" class="level4">
<h4 class="anchored" data-anchor-id="positive-reviews">1.3 Positive Reviews</h4>
<section id="analyze-frequent-word-in-positive-review" class="level5">
<h5 class="anchored" data-anchor-id="analyze-frequent-word-in-positive-review">Analyze Frequent Word in Positive Review</h5>
<div id="84717ad3" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter reviews with positive sentiment scores</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>positive_reviews <span class="op">=</span> yelp_df[yelp_df[<span class="st">'textblob_score'</span>] <span class="op">&gt;</span> <span class="dv">0</span>]</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Flatten the list of tokens from negative reviews for frequency analysis</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>positive_tokens <span class="op">=</span> [token <span class="cf">for</span> tokens <span class="kw">in</span> positive_reviews[<span class="st">'tokens'</span>] <span class="cf">for</span> token <span class="kw">in</span> tokens]</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>positive_freq_dist <span class="op">=</span> Counter(positive_tokens)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the top 10 most common words in negative reviews</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>positive_common_words <span class="op">=</span> positive_freq_dist.most_common(<span class="dv">10</span>)</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(positive_common_words)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[('good', 2579), ('great', 2013), ('like', 1855), ('time', 1610), ('one', 1582), ('get', 1524), ('go', 1371), ('back', 1098), ('love', 917), ('nice', 881)]</code></pre>
</div>
</div>
</section>
<section id="visualize-frequent-words-in-positive-reviews" class="level5">
<h5 class="anchored" data-anchor-id="visualize-frequent-words-in-positive-reviews">Visualize Frequent Words in Positive Reviews</h5>
<div id="5f46cb4e" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the most common words in negative reviews</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>words, counts <span class="op">=</span> <span class="bu">zip</span>(<span class="op">*</span>positive_common_words)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>plt.bar(words, counts, color<span class="op">=</span><span class="st">'skyblue'</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Most Common Words in Positive Reviews'</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Words'</span>)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Frequency'</span>)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-23-output-1.png" width="828" height="529" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="relationship-between-words" class="level5">
<h5 class="anchored" data-anchor-id="relationship-between-words">Relationship between words</h5>
<div id="00f2d4f2" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the relationship between target word to others words</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> relationship_words(target_word, data):</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get the number of available CPU cores</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    num_cores <span class="op">=</span> multiprocessing.cpu_count()</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> Word2Vec(data[<span class="st">'tokens'</span>], vector_size<span class="op">=</span><span class="dv">100</span>, window<span class="op">=</span><span class="dv">5</span>, min_count<span class="op">=</span><span class="dv">3</span>, workers<span class="op">=</span>num_cores)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>    model.train(yelp_df[<span class="st">'tokens'</span>], total_examples<span class="op">=</span><span class="bu">len</span>(yelp_df), epochs<span class="op">=</span><span class="dv">30</span>)</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get the most similar words</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>    similar_words <span class="op">=</span> model.wv.most_similar(target_word, topn<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create a graph from the co-occurrence matrix</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>    G <span class="op">=</span> nx.Graph()</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add nodes and edges</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> word, weight <span class="kw">in</span> similar_words:</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>        G.add_edge(target_word, word, weight<span class="op">=</span>weight)</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Draw the graph</span></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>))</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>    pos <span class="op">=</span> nx.spring_layout(G, k<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>    nx.draw(G, pos, with_labels<span class="op">=</span><span class="va">True</span>, node_size<span class="op">=</span><span class="dv">3000</span>, node_color<span class="op">=</span><span class="st">'skyblue'</span>, font_size<span class="op">=</span><span class="dv">15</span>, font_weight<span class="op">=</span><span class="st">'bold'</span>, edge_color<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="ss">f'Network Graph of Words with </span><span class="sc">{</span>target_word<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Letâ€™s check the relationship of â€œgoodâ€ and â€œgreatâ€</p>
<div id="7c385381" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>relationship_words(<span class="st">'good'</span>, yelp_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-25-output-1.png" width="979" height="999" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="9f4812ad" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>relationship_words(<span class="st">'great'</span>, yelp_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-26-output-1.png" width="979" height="999" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="negative-reviews" class="level4">
<h4 class="anchored" data-anchor-id="negative-reviews">1.4 Negative Reviews</h4>
<section id="analyze-frequent-words-in-negative-reviews" class="level5">
<h5 class="anchored" data-anchor-id="analyze-frequent-words-in-negative-reviews">Analyze Frequent Words in Negative Reviews</h5>
<p>Filter the reviews with negative sentiment scores and perform a word frequency analysis on these reviews.</p>
<div id="8490ec03" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-07-04T21:52:48.613653100Z&quot;,&quot;start_time&quot;:&quot;2024-07-04T21:52:48.341422400Z&quot;}" data-execution_count="26">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter reviews with negative sentiment scores</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>negative_reviews <span class="op">=</span> yelp_df[yelp_df[<span class="st">'textblob_score'</span>] <span class="op">&lt;</span> <span class="dv">0</span>]</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Flatten the list of tokens from negative reviews for frequency analysis</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>negative_tokens <span class="op">=</span> [token <span class="cf">for</span> tokens <span class="kw">in</span> negative_reviews[<span class="st">'tokens'</span>] <span class="cf">for</span> token <span class="kw">in</span> tokens]</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>negative_freq_dist <span class="op">=</span> Counter(negative_tokens)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the top 10 most common words in negative reviews</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>negative_common_words <span class="op">=</span> negative_freq_dist.most_common(<span class="dv">10</span>)</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(negative_common_words)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[('one', 154), ('like', 149), ('time', 139), ('get', 132), ('go', 115), ('chicken', 106), ('back', 95), ('good', 78), ('bad', 73), ('order', 60)]</code></pre>
</div>
</div>
</section>
<section id="visualize-frequent-words-in-negative-reviews" class="level5">
<h5 class="anchored" data-anchor-id="visualize-frequent-words-in-negative-reviews">Visualize Frequent Words in Negative Reviews</h5>
<p>Create a bar chart to visualize the most common words in negative reviews.</p>
<div id="f676d97e" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-07-04T21:52:48.812801300Z&quot;,&quot;start_time&quot;:&quot;2024-07-04T21:52:48.374165300Z&quot;}" data-execution_count="27">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the most common words in negative reviews</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>words, counts <span class="op">=</span> <span class="bu">zip</span>(<span class="op">*</span>negative_common_words)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>plt.bar(words, counts, color<span class="op">=</span><span class="st">'skyblue'</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Most Common Words in Negative Reviews'</span>)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Words'</span>)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Frequency'</span>)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-28-output-1.png" width="820" height="529" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="relationship-among-words" class="level5">
<h5 class="anchored" data-anchor-id="relationship-among-words">Relationship among words</h5>
<p>The relationship among words of â€œlikeâ€ and â€œoneâ€</p>
<div id="3002eae5" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>relationship_words(<span class="st">'like'</span>, yelp_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-29-output-1.png" width="979" height="999" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cfa99b80" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>relationship_words(<span class="st">'time'</span>, yelp_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-30-output-1.png" width="979" height="999" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="vader" class="level3">
<h3 class="anchored" data-anchor-id="vader">2. VADER</h3>
<section id="perform-sentiment-analysis" class="level4">
<h4 class="anchored" data-anchor-id="perform-sentiment-analysis">2.1 Perform sentiment analysis</h4>
<p>The Compound score is a metric that calculates the sum of all the lexicon ratings which have been normalized between [-1, 1]. Similar to Textblob Polarity, -1 denotes the highly negative sentiment and 1 denotes a highly positive sentiment. By default, the VADER documentation suggests using a threshold where:</p>
<ul>
<li><p>Positive Sentiment: Compound score â‰¥ 0.05</p></li>
<li><p>Neutral Sentiment: Compound score between -0.05 and 0.05</p></li>
<li><p>Negative Sentiment: Compound score â‰¤ -0.05</p></li>
</ul>
<div id="2c4fde89" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic preprocessing function</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> preprocess_text_for_vader(text):</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> re.sub(<span class="vs">r'&lt;.*?&gt;'</span>, <span class="st">''</span>, text)  <span class="co"># Remove HTML tags</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> re.sub(<span class="vs">r'[^a-zA-Z\s]'</span>, <span class="st">''</span>, text)  <span class="co"># Remove non-alphabet characters</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> text.lower()  <span class="co"># Convert to lowercase</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> text</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply basic preprocessing</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>yelp_df[<span class="st">'cleaned_text'</span>] <span class="op">=</span> yelp_df[<span class="st">'text'</span>].<span class="bu">apply</span>(preprocess_text_for_vader)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="0e45f734" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>sentiment <span class="op">=</span> SentimentIntensityAnalyzer()</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>yelp_df[<span class="st">'vader_score'</span>] <span class="op">=</span> yelp_df[<span class="st">'cleaned_text'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: sentiment.polarity_scores(x)[<span class="st">'compound'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="136f3b3e" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the sentiment analysis</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>plt.hist(yelp_df[<span class="st">'vader_score'</span>], bins<span class="op">=</span><span class="dv">20</span>, color<span class="op">=</span><span class="st">'skyblue'</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Sentiment Analysis of Yelp Reviews'</span>)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Vader Score'</span>)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Frequency'</span>)</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-33-output-1.png" width="828" height="529" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The histogram shows a highly skewed distribution toward the positive end of the sentiment spectrum and the majority of sentiment score are concentrated between 0.75 to 1. This is consistent with the expectation that people are more likely leave positive feedback when satisfied</p>
</section>
<section id="compare-sentiment" class="level4">
<h4 class="anchored" data-anchor-id="compare-sentiment">2.2 Compare Sentiment</h4>
<div id="ee2aa6f5" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a scatter plot to compare star ratings with sentiment scores</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>plt.scatter(yelp_df[<span class="st">'stars'</span>], yelp_df[<span class="st">'vader_score'</span>], alpha<span class="op">=</span><span class="fl">0.5</span>, color<span class="op">=</span><span class="st">'blue'</span>)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Comparison of Star Ratings and Sentiment Scores'</span>)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Star Ratings'</span>)</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Sentiment Score'</span>)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-34-output-1.png" width="833" height="529" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The sentiment scores for each star rating range broadly from -1 to 1.This could be due to mixed sentiments within the reviews or limitation in the sentiment analysis model.</p>
<p>The posible reason could be:</p>
<ul>
<li><p>Some reviews may contain both positive and negative comments, leading to mixed sentiment scores</p></li>
<li><p>Star ratings might not always reflext the textâ€™s sentiment accurately.</p></li>
<li><p>Vader considers aspects like punctuation, capitalization and intensifiers. If reviews use strong language or emphatic expressions, this can skew the sentiment score</p></li>
</ul>
</section>
<section id="positive-reviews-1" class="level4">
<h4 class="anchored" data-anchor-id="positive-reviews-1">2.3 Positive Reviews</h4>
<div id="a088362f" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter reviews with positive sentiment scores</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>positive_reviews_vader <span class="op">=</span> yelp_df[yelp_df[<span class="st">'vader_score'</span>] <span class="op">&gt;</span> <span class="fl">0.5</span>]</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Flatten the list of tokens from negative reviews for frequency analysis</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>positive_tokens <span class="op">=</span> [token <span class="cf">for</span> tokens <span class="kw">in</span> positive_reviews_vader[<span class="st">'tokens'</span>] <span class="cf">for</span> token <span class="kw">in</span> tokens]</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>positive_freq_dist <span class="op">=</span> Counter(positive_tokens)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the top 10 most common words in negative reviews</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>positive_common_words <span class="op">=</span> positive_freq_dist.most_common(<span class="dv">10</span>)</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(positive_common_words)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[('good', 2402), ('great', 1944), ('like', 1745), ('one', 1474), ('time', 1468), ('get', 1397), ('go', 1277), ('back', 982), ('love', 898), ('nice', 845)]</code></pre>
</div>
</div>
<div id="40420776" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the most common words in negative reviews</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>words, counts <span class="op">=</span> <span class="bu">zip</span>(<span class="op">*</span>positive_common_words)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>plt.bar(words, counts, color<span class="op">=</span><span class="st">'skyblue'</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Most Common Words in Positive Reviews'</span>)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Words'</span>)</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Frequency'</span>)</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-36-output-1.png" width="828" height="529" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="negative-reviews-1" class="level4">
<h4 class="anchored" data-anchor-id="negative-reviews-1">2.4 Negative Reviews</h4>
<div id="95db0953" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter reviews with positive sentiment scores</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>negative_reviews_vader <span class="op">=</span> yelp_df[yelp_df[<span class="st">'vader_score'</span>] <span class="op">&lt;</span>  <span class="op">-</span><span class="fl">0.5</span>]</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Flatten the list of tokens from negative reviews for frequency analysis</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>negative_tokens <span class="op">=</span> [token <span class="cf">for</span> tokens <span class="kw">in</span> negative_reviews_vader[<span class="st">'tokens'</span>] <span class="cf">for</span> token <span class="kw">in</span> tokens]</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>negative_freq_dist <span class="op">=</span> Counter(negative_tokens)</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the top 10 most common words in negative reviews</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>negative_common_words <span class="op">=</span> negative_freq_dist.most_common(<span class="dv">10</span>)</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(negative_common_words)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[('time', 148), ('one', 135), ('get', 131), ('like', 124), ('back', 115), ('good', 111), ('go', 107), ('bad', 75), ('never', 68), ('way', 62)]</code></pre>
</div>
</div>
<div id="41d75741" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the most common words in negative reviews</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>words, counts <span class="op">=</span> <span class="bu">zip</span>(<span class="op">*</span>negative_common_words)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>plt.bar(words, counts, color<span class="op">=</span><span class="st">'skyblue'</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Most Common Words in Negative Reviews'</span>)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Words'</span>)</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Frequency'</span>)</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-38-output-1.png" width="820" height="529" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="compare-accuracy-of-both-vader-and-texrblob" class="level3">
<h3 class="anchored" data-anchor-id="compare-accuracy-of-both-vader-and-texrblob">Compare Accuracy of both VADER and TexrBlob</h3>
<p>Assume the following mapping:</p>
<ul>
<li><p>1-2 stars: Negative sentiment</p></li>
<li><p>3 stars: Neutral sentiment</p></li>
<li><p>4-5 stars: Positive sentiment</p></li>
</ul>
<div id="663a60bd" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define function to convert star ratings to sentiment labels</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sentiment_label(stars):</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> stars <span class="op">&gt;=</span> <span class="dv">4</span>:</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'positive'</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> stars <span class="op">&lt;=</span> <span class="dv">2</span>:</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'negative'</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'neutral'</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the function to create a new column</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>yelp_df[<span class="st">'actual_sentiment'</span>] <span class="op">=</span> yelp_df[<span class="st">'stars'</span>].<span class="bu">apply</span>(sentiment_label)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="49c0dab5" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert predicted sentiment for both TextBlob and VADER to sentiment label</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> textblob_sentiment_label(score):</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> score <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'positive'</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> score <span class="op">&lt;</span> <span class="dv">0</span>:</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'negative'</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'neutral'</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> vader_sentiment_label(score):</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> score <span class="op">&gt;</span> <span class="fl">0.5</span>:</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'positive'</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> score <span class="op">&lt;</span> <span class="op">-</span><span class="fl">0.5</span>:</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'negative'</span></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'neutral'</span></span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the functions to yelp_df</span></span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>yelp_df[<span class="st">'sentiment_textblob'</span>] <span class="op">=</span> yelp_df[<span class="st">'textblob_score'</span>].<span class="bu">apply</span>(textblob_sentiment_label)</span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>yelp_df[<span class="st">'sentiment_vader'</span>] <span class="op">=</span> yelp_df[<span class="st">'vader_score'</span>].<span class="bu">apply</span>(vader_sentiment_label)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="08ee9411" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the accuracy of TextBlob sentiment analysis</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>textblob_accuracy <span class="op">=</span> accuracy_score(yelp_df[<span class="st">'actual_sentiment'</span>], yelp_df[<span class="st">'sentiment_textblob'</span>])</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the accuracy of VADER sentiment analysis</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>vader_accuracy <span class="op">=</span> accuracy_score(yelp_df[<span class="st">'actual_sentiment'</span>], yelp_df[<span class="st">'sentiment_vader'</span>])</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'TextBlob Accuracy: </span><span class="sc">{</span>textblob_accuracy<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'VADER Accuracy: </span><span class="sc">{</span>vader_accuracy<span class="sc">:.2f}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>TextBlob Accuracy: 0.72
VADER Accuracy: 0.71</code></pre>
</div>
</div>
<p>The accuracy scores for TextBlob and VADER are quite close. TextBlob has slighly higher accuracy but not significant, which means both TextBlob and VADER are suitable for sentiment analysis on this dataset</p>
</section>
</section>
<section id="top-modeling-with-lda" class="level2">
<h2 class="anchored" data-anchor-id="top-modeling-with-lda">Top Modeling with LDA</h2>
<section id="preprocessing-for-topic-modeling" class="level3">
<h3 class="anchored" data-anchor-id="preprocessing-for-topic-modeling">Preprocessing for Topic Modeling</h3>
<div id="7a081f13" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_extraction.text <span class="im">import</span> TfidfVectorizer</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Recall the positive and negative reviews from the sensitivity analysis using TextBlob</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>positive_reviews <span class="op">=</span> yelp_df[yelp_df[<span class="st">'textblob_score'</span>] <span class="op">&gt;</span> <span class="dv">0</span>]</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>negative_reviews<span class="op">=</span> yelp_df[yelp_df[<span class="st">'textblob_score'</span>] <span class="op">&lt;</span> <span class="dv">0</span>]</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Vectorize the text data using TF-IDF</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>vectorizer_positive <span class="op">=</span> TfidfVectorizer(max_features<span class="op">=</span><span class="dv">5000</span>, stop_words<span class="op">=</span><span class="st">'english'</span>)</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>vectorizer_negative <span class="op">=</span> TfidfVectorizer(max_features<span class="op">=</span><span class="dv">5000</span>, stop_words<span class="op">=</span><span class="st">'english'</span>)</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>positive_tfidf <span class="op">=</span> vectorizer_positive.fit_transform(positive_reviews[<span class="st">'tokens'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="st">' '</span>.join(x)))</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>negative_tfidf <span class="op">=</span> vectorizer_negative.fit_transform(negative_reviews[<span class="st">'tokens'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="st">' '</span>.join(x)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="topic-modeling-for-positive-reviews" class="level3">
<h3 class="anchored" data-anchor-id="topic-modeling-for-positive-reviews">Topic Modeling for Positive Reviews</h3>
<div id="4717cdc6" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.decomposition <span class="im">import</span> LatentDirichletAllocation</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Topic Modeling for Positive Reviews</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>n_topics <span class="op">=</span> <span class="dv">5</span>  <span class="co"># Number of topics</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>lda_positive <span class="op">=</span> LatentDirichletAllocation(n_components<span class="op">=</span>n_topics, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>lda_positive.fit(positive_tfidf)</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the topics for positive reviews</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> display_topics(model, feature_names, n_top_words):</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> topic_idx, topic <span class="kw">in</span> <span class="bu">enumerate</span>(model.components_):</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Topic #</span><span class="sc">{</span>topic_idx <span class="op">+</span> <span class="dv">1</span><span class="sc">}</span><span class="ss">:"</span>)</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">" "</span>.join([feature_names[i] <span class="cf">for</span> i <span class="kw">in</span> topic.argsort()[:<span class="op">-</span>n_top_words <span class="op">-</span> <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>]]))</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>()</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>n_top_words <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>tf_feature_names_positive <span class="op">=</span> vectorizer_positive.get_feature_names_out()</span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Positive Reviews Topics:"</span>)</span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>display_topics(lda_positive, tf_feature_names_positive, n_top_words)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Positive Reviews Topics:
Topic #1:
good great like time love pizza nice best bar friendly

Topic #2:
great love store staff like good location dog friendly price

Topic #3:
donut dr doctor vet lesson aunt fabric insurance caring reviewed

Topic #4:
lee ethiopian winning lox earl lite chalet lifter society tour

Topic #5:
theater imax pedi moore cigar jennifer gras film amc bertha
</code></pre>
</div>
</div>
<section id="visualizing-the-topic-of-positive-reviews" class="level4">
<h4 class="anchored" data-anchor-id="visualizing-the-topic-of-positive-reviews">Visualizing the Topic of Positive Reviews</h4>
<div id="b5b3eff9" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pyLDAvis</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pyLDAvis.lda_model</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare the LDA visualization for positive reviews</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>pyLDAvis.enable_notebook()</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>panel_positive <span class="op">=</span> pyLDAvis.lda_model.prepare(lda_positive, positive_tfidf, vectorizer_positive)</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"LDA Visualization for Positive Reviews"</span>)</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>pyLDAvis.display(panel_positive)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>LDA Visualization for Positive Reviews</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="43">

<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/bmabey/pyLDAvis@3.4.0/pyLDAvis/js/ldavis.v1.0.0.css">


<div id="ldavis_el50902110807382723060654481" style="background-color:white;"></div>
<script type="text/javascript">

var ldavis_el50902110807382723060654481_data = {"mdsDat": {"x": [-0.11655799810342574, -0.04434082326970612, 0.06190548633814558, 0.05030013958142608, 0.04869319545356021], "y": [-0.04166897014604473, 0.07247138830022061, -0.00958986334440215, -0.010478578911873232, -0.010733975897900488], "topics": [1, 2, 3, 4, 5], "cluster": [1, 1, 1, 1, 1], "Freq": [78.28660734363419, 11.979150738498467, 3.4068569436986427, 3.181914738959388, 3.145470235209305]}, "tinfo": {"Term": ["great", "love", "store", "staff", "location", "donut", "like", "friendly", "dr", "dog", "price", "theater", "best", "shop", "selection", "fast", "mexican", "taco", "year", "salsa", "need", "looking", "free", "clean", "good", "make", "new", "time", "thing", "park", "salad", "pizza", "bread", "sandwich", "sushi", "breakfast", "ordered", "wine", "soup", "lunch", "roll", "enjoyed", "egg", "plate", "shrimp", "spicy", "pork", "served", "server", "potato", "meal", "group", "dessert", "portion", "sauce", "cheese", "tomato", "dinner", "loved", "waitress", "chicken", "meat", "bar", "night", "burger", "menu", "drink", "table", "good", "dish", "order", "friend", "try", "time", "went", "delicious", "great", "like", "hour", "nice", "pretty", "best", "got", "love", "better", "friendly", "price", "make", "staff", "shoe", "nail", "wifi", "http", "nordstrom", "pedicure", "camelback", "trail", "department", "hike", "boba", "german", "security", "www", "mole", "scott", "biz", "curd", "haircut", "dvd", "wander", "chino", "exchange", "mission", "gel", "bowling", "steve", "airline", "hall", "beet", "clothing", "tire", "salon", "dentist", "massage", "park", "bike", "store", "asada", "yogurt", "dog", "carne", "frozen", "book", "shop", "mountain", "hair", "sale", "love", "great", "location", "mexican", "fast", "staff", "salsa", "selection", "taco", "friendly", "like", "price", "free", "looking", "good", "year", "best", "need", "time", "clean", "make", "nice", "thing", "new", "know", "vet", "doctor", "donut", "dr", "fabric", "aunt", "insurance", "duke", "lesson", "wally", "defiantly", "estimate", "jones", "yogurtology", "groomed", "physician", "caring", "sandbar", "bosa", "battery", "medal", "pb", "reviewed", "mechanic", "fru", "carpet", "pischke", "groomers", "awsome", "kang", "organ", "surgery", "zoo", "medical", "patient", "physical", "older", "theater", "imax", "pedi", "moore", "cigar", "gras", "jennifer", "bertha", "amc", "hateful", "sneaker", "film", "breadstick", "foie", "innova", "nibble", "boombozz", "wal", "invitation", "reported", "cough", "loudly", "concession", "mart", "forefather", "cleanest", "mani", "jim", "contemporary", "padi", "exit", "classy", "cheesy", "thinking", "interesting", "spectacular", "lee", "ethiopian", "lox", "winning", "earl", "lite", "chalet", "lifter", "society", "baiz", "plumbing", "ladybug", "humane", "payton", "plantation", "scuba", "mikado", "guided", "teach", "padi", "source", "tammie", "vast", "introducing", "frosty", "oooh", "explains", "cough", "spotless", "ac", "tour", "treated", "plastic", "despite", "exactly"], "Freq": [113.0, 66.0, 23.0, 43.0, 32.0, 6.0, 77.0, 48.0, 6.0, 15.0, 46.0, 5.0, 53.0, 16.0, 26.0, 19.0, 19.0, 22.0, 29.0, 18.0, 27.0, 22.0, 21.0, 26.0, 116.0, 40.0, 29.0, 74.0, 38.0, 9.0, 41.29950651352225, 49.784663192828965, 24.555128014540006, 34.675207995826234, 22.63307110228039, 25.567090983633943, 36.41126763026674, 26.15026597843968, 20.491186605455383, 38.740563494975646, 18.102654744809094, 19.43426662709193, 17.636981596687693, 18.971937316800723, 16.16347304504098, 16.560542962805865, 16.14388575562255, 15.43321861145907, 23.480649881612326, 20.96844531586664, 33.18461021547735, 15.970740343148154, 16.424984680201355, 20.043639741157204, 30.17953217728804, 34.23519857540636, 14.976554367831893, 27.344363982092194, 21.755245273164277, 16.1360726685129, 40.323207849507995, 22.367340507795728, 41.72355855529156, 36.69691955728487, 37.061440133516655, 40.696025086885236, 40.6325091357474, 29.944198102169583, 108.1713582841398, 28.41729276138445, 37.118116934779536, 33.96309445032733, 40.19717369519863, 67.896164012157, 32.90182375353738, 39.331171251177466, 100.06235617899135, 69.43272333038583, 34.5904791295636, 49.32355755319011, 40.502902660165006, 47.08724096425874, 36.61280405210551, 55.69906889866822, 37.16301458212225, 41.57456651994069, 40.16650029787485, 35.22636080030933, 35.28642343404657, 4.723160382697849, 4.124440496984115, 2.6599383195328876, 2.2905968793128824, 2.2660549058425543, 2.21427344180272, 2.5314810710871187, 2.1512485674199344, 2.332005370599491, 2.082453475634952, 2.1066087439578465, 1.9787021563402316, 1.8683252845479463, 1.7131981727592842, 1.7161460706942118, 1.6985582049148085, 1.6795634006304982, 1.6670654543249672, 1.6463283989942756, 1.7915292992426224, 1.6394972897359872, 1.5822393427763044, 1.5598921384673978, 1.7693017854704194, 1.4755288672540527, 1.4664325763579737, 1.4569533196063402, 1.7998164011954887, 1.4367899773139985, 1.4099760239591574, 2.095099694979361, 2.692172670796514, 2.8329491567065292, 1.9588147385779946, 3.159683023473341, 5.254673633611404, 2.9423689259965258, 9.628050511250208, 3.60004590863342, 3.508951425875849, 6.714352184329955, 3.827870583420753, 3.889324812483461, 3.9453004853482105, 6.1291670552006945, 2.5058945680638565, 3.147122358029351, 3.1880217376250424, 10.42135699922272, 13.347465338099624, 6.898286717061562, 5.341272245992616, 5.355797623977696, 7.566552379488259, 4.903391074866764, 5.527856276522552, 4.963132099354806, 6.4934764452573015, 7.559158324584342, 6.320123067941816, 4.733042912419148, 4.7611778893798995, 7.474374162728464, 5.018074312961798, 5.9435085834344115, 4.873120325554172, 6.103191527026148, 4.716513368340184, 4.973852224053227, 5.228386498150127, 4.783095149276297, 4.532385036314666, 4.3856013633004505, 1.8044653054512836, 2.556948621274062, 4.70412711296855, 4.503224220180839, 1.2682561671357446, 1.2865992761309357, 1.1917664256547431, 0.9764111693418527, 1.3813390142332655, 0.9079175685715029, 1.0216459928440833, 0.8314177752835502, 0.8000993899308275, 0.8014234940362187, 0.7877788548947445, 0.7637534132361498, 1.120371928921398, 0.755036765508995, 0.7497473584880562, 0.7349831787032438, 0.6864627802979468, 0.6955205490917695, 1.0230144098390141, 0.7361791970263553, 0.6664702619708766, 0.6625462456544213, 0.6161906258751548, 0.6084469941936007, 0.6477553181757459, 0.6201840063114988, 0.8265441719878454, 0.8441930054167504, 0.7572772920652121, 0.6954072382391032, 0.8464632874316251, 0.6689450416083295, 0.6758034985213409, 4.744368473361059, 1.5617882965761962, 1.2840683418824745, 1.0922235449607183, 0.8921579698795524, 0.8091933904405354, 0.8646170802032734, 0.7042494506146948, 0.7220852766698477, 0.5200046487794543, 0.6013598692484092, 0.7601395253905591, 0.6575669240791734, 0.45743592095690766, 0.4558747219331477, 0.4558747219331477, 0.4546158552967906, 0.6333708614315616, 0.45081217996129364, 0.5484815811140986, 0.5429943470566432, 0.40956331603004065, 0.4846344359687944, 0.5745781983174592, 0.39284535641735635, 0.43066610408547407, 0.44768241638331757, 0.4253563432757567, 0.4190387231583424, 0.26854614906170304, 0.36787957329114135, 0.5221000406837979, 0.4717890102334055, 0.4647759673135972, 0.44947645145029413, 0.4277805625202706, 2.3962106158415333, 1.3204241105970016, 1.0935451827977232, 1.1572138668611711, 0.8137202555090235, 0.8034466225469803, 0.7042753250257319, 0.6962723755337242, 0.6535422709893545, 0.635054157387161, 0.6194835736623113, 0.5388688658829406, 0.49628700292036904, 0.46121160232172037, 0.5017232598878624, 0.42336762587209886, 0.4168589154437935, 0.4460750843352099, 0.4090926471149741, 0.3094814738052752, 0.3609039017353106, 0.337742579009403, 0.4707998186479789, 0.3166225807971123, 0.3553406488630188, 0.34160905841576883, 0.2886090530803806, 0.3626874485069056, 0.4473703560168358, 0.6009420459896017, 0.6446076534533622, 0.4593072071893338, 0.41673202715565544, 0.4068654345811243, 0.374560063082048], "Total": [113.0, 66.0, 23.0, 43.0, 32.0, 6.0, 77.0, 48.0, 6.0, 15.0, 46.0, 5.0, 53.0, 16.0, 26.0, 19.0, 19.0, 22.0, 29.0, 18.0, 27.0, 22.0, 21.0, 26.0, 116.0, 40.0, 29.0, 74.0, 38.0, 9.0, 41.840465810233496, 50.477274827164415, 25.076560879691613, 35.4310592021518, 23.130003236504034, 26.15375317950358, 37.2709359032013, 26.815554027946334, 21.02080749252908, 39.807443051477605, 18.611681863677738, 19.992149496371955, 18.145551229910925, 19.553309226986308, 16.66567528944384, 17.075581234528553, 16.66365291658864, 15.93471320800444, 24.24418523716549, 21.65050546573022, 34.27551592066988, 16.500003610354558, 16.985441808593844, 20.733572292788665, 31.230708589610916, 35.4284972779205, 15.498924097703307, 28.302037788422176, 22.520185676376194, 16.708310117194465, 41.78763612941896, 23.190770503826617, 43.60903478984609, 38.3228951529648, 38.75761285138774, 42.651255712394544, 42.62648860740248, 31.242473076468045, 116.01530451217768, 29.670968803084126, 39.21272177140571, 35.83926513892764, 42.742936849666236, 74.3676561230985, 34.701436188519914, 41.884642970754584, 113.7805643205859, 77.36021756221938, 37.00605238549166, 54.920222029701165, 44.32330437018622, 53.76123067945891, 40.09416787732656, 66.48872246503376, 41.13119206258618, 48.50923914293785, 46.8548341769568, 40.568433508564446, 43.22176188019239, 5.275582485267455, 4.806575044561304, 3.211614166295334, 2.8460340898290686, 2.815646171168993, 2.755917095609852, 3.16746351302077, 2.692465570134386, 2.9190578683256607, 2.6244806658119195, 2.659980835381494, 2.527282107892272, 2.4202151136357446, 2.2571833169071556, 2.2637724290332644, 2.245110970002162, 2.22322320467754, 2.2171211020886017, 2.189998316280794, 2.383436682999765, 2.1868603125421022, 2.1251938990431465, 2.1027378000863988, 2.4122220629734317, 2.018015006357779, 2.0093175497658113, 2.0069999847564355, 2.4884069772730153, 2.000703037755999, 1.9742011328813474, 2.955765903138715, 3.9027026875041337, 4.263391423007236, 2.828843306676779, 5.036994919833937, 9.465744101557034, 4.830521554556409, 23.569044860214095, 6.437004339049622, 6.343790492723125, 15.90887840564562, 7.357083655915018, 7.86045052294678, 8.153933281868968, 16.554193298422742, 4.140506112661966, 6.132029995922322, 6.314803258266416, 66.48872246503376, 113.7805643205859, 32.92998261841637, 19.472217184367228, 19.67491265666187, 43.22176188019239, 18.027541910881368, 26.1217198508084, 22.925753250562448, 48.50923914293785, 77.36021756221938, 46.8548341769568, 21.703590894202684, 22.120151769343426, 116.01530451217768, 29.9913087665503, 53.76123067945891, 27.33936626522069, 74.3676561230985, 26.23188632776883, 40.568433508564446, 54.920222029701165, 38.842605538503975, 29.13574024321295, 36.6555872852723, 2.3608833736214914, 3.428649489977535, 6.406333075670419, 6.147534547603224, 1.828851167525136, 1.8591129761042002, 1.747120111803775, 1.5342462684382632, 2.192285766902784, 1.4750794607077873, 1.6756901422172268, 1.3863986213895323, 1.3519963122817078, 1.3557785042538888, 1.3463153141264932, 1.3100300572623338, 1.9228730278347554, 1.3065735612243634, 1.2974606347159119, 1.2877914064998839, 1.235227609355535, 1.2521025199820222, 1.8438588661050124, 1.3423811255306655, 1.2253160393846303, 1.2213185826594912, 1.1632658049482454, 1.157422411478616, 1.2347588538934637, 1.1961187156507198, 1.5983822334777646, 1.8409985422928572, 1.6808431799013333, 1.5404438293419493, 3.373131452495341, 1.3945053467245836, 4.323875701587704, 5.3017031896379105, 2.1118199781421083, 1.8406238301970828, 1.690492461027025, 1.4641077153782869, 1.3804622161264204, 1.509753316643852, 1.2570571025400787, 1.2927332262589617, 1.0712951588775927, 1.2889822635468997, 1.646421355723241, 1.4300672696013332, 1.007216299625389, 1.0050154576230732, 1.0050154576230732, 1.0086119212434952, 1.4700965385146594, 1.1056744790310926, 1.351628063491727, 1.3947863416044997, 1.081553835619904, 1.3047870290049797, 1.6469097621664277, 1.1301597125428944, 1.3202969655794046, 1.5413370215061146, 1.5342690803580703, 1.583163754662051, 1.0288130483182645, 1.5435810902812568, 3.810917638376792, 3.5820717063584926, 5.886683954729032, 8.978504266829287, 5.084555176561748, 2.953476360239917, 1.890665191412927, 1.6525552697377595, 1.7500923843627618, 1.3688891095994673, 1.3646089736274676, 1.2667519737630095, 1.264447747220804, 1.213827790852207, 1.2003589478757477, 1.1800003719121919, 1.090959884114417, 1.057308075844873, 1.0178825237698008, 1.1462725510742873, 0.9788594627706031, 0.978134863880549, 1.1952257775233872, 1.3110087532859664, 1.0288130483182645, 1.2041973895409648, 1.1765726955304052, 1.672310961197496, 1.136815759205861, 1.3301767136628828, 1.284219134306774, 1.1023781016658571, 1.3947863416044997, 1.7802915300173423, 2.4821646352509177, 4.169961228147206, 2.7273836442722494, 4.049643203106709, 4.837393528466179, 7.113160443097138], "Category": ["Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5"], "logprob": [30.0, 29.0, 28.0, 27.0, 26.0, 25.0, 24.0, 23.0, 22.0, 21.0, 20.0, 19.0, 18.0, 17.0, 16.0, 15.0, 14.0, 13.0, 12.0, 11.0, 10.0, 9.0, 8.0, 7.0, 6.0, 5.0, 4.0, 3.0, 2.0, 1.0, -5.9381, -5.7512, -6.458, -6.1129, -6.5395, -6.4176, -6.064, -6.395, -6.6389, -6.002, -6.7628, -6.6919, -6.7889, -6.7159, -6.8761, -6.8519, -6.8774, -6.9224, -6.5027, -6.6159, -6.1568, -6.8881, -6.8601, -6.661, -6.2517, -6.1256, -6.9524, -6.3504, -6.579, -6.8778, -5.962, -6.5513, -5.9278, -6.0562, -6.0463, -5.9528, -5.9543, -6.2596, -4.9752, -6.3119, -6.0448, -6.1336, -5.9651, -5.4409, -6.1654, -5.9869, -5.0531, -5.4185, -6.1153, -5.7605, -5.9575, -5.8069, -6.0585, -5.6389, -6.0436, -5.9314, -5.9659, -6.0971, -6.0954, -6.2292, -6.3648, -6.8034, -6.9529, -6.9637, -6.9868, -6.8529, -7.0156, -6.935, -7.0481, -7.0366, -7.0993, -7.1566, -7.2433, -7.2416, -7.2519, -7.2632, -7.2706, -7.2831, -7.1986, -7.2873, -7.3229, -7.3371, -7.2111, -7.3927, -7.3989, -7.4053, -7.194, -7.4193, -7.4381, -7.0421, -6.7913, -6.7404, -7.1094, -6.6312, -6.1226, -6.7025, -5.517, -6.5007, -6.5264, -5.8774, -6.4394, -6.4235, -6.4092, -5.9686, -6.863, -6.6352, -6.6223, -5.4378, -5.1904, -5.8504, -6.1062, -6.1035, -5.758, -6.1918, -6.0719, -6.1797, -5.9109, -5.7589, -5.938, -6.2271, -6.2212, -5.7702, -6.1686, -5.9994, -6.198, -5.9729, -6.2306, -6.1775, -6.1276, -6.2166, -6.2704, -6.3034, -5.9341, -5.5855, -4.9759, -5.0195, -6.2867, -6.2723, -6.3489, -6.5482, -6.2013, -6.6209, -6.5029, -6.7089, -6.7473, -6.7457, -6.7629, -6.7938, -6.4107, -6.8053, -6.8123, -6.8322, -6.9005, -6.8874, -6.5016, -6.8306, -6.9301, -6.936, -7.0085, -7.0212, -6.9586, -7.0021, -6.7148, -6.6937, -6.8023, -6.8876, -6.691, -6.9264, -6.9162, -4.899, -6.0102, -6.206, -6.3678, -6.5701, -6.6677, -6.6015, -6.8066, -6.7816, -7.1099, -6.9646, -6.7303, -6.8752, -7.2381, -7.2415, -7.2415, -7.2443, -6.9127, -7.2527, -7.0566, -7.0667, -7.3487, -7.1804, -7.0101, -7.3903, -7.2984, -7.2597, -7.3108, -7.3258, -7.7707, -7.456, -7.1059, -7.2072, -7.2222, -7.2557, -7.3052, -5.5706, -6.1665, -6.3551, -6.2985, -6.6506, -6.6633, -6.7951, -6.8065, -6.8698, -6.8985, -6.9234, -7.0628, -7.1451, -7.2184, -7.1342, -7.304, -7.3195, -7.2518, -7.3383, -7.6173, -7.4636, -7.53, -7.1978, -7.5945, -7.4792, -7.5186, -7.6872, -7.4587, -7.2489, -6.9537, -6.8836, -7.2225, -7.3198, -7.3438, -7.4265], "loglift": [30.0, 29.0, 28.0, 27.0, 26.0, 25.0, 24.0, 23.0, 22.0, 21.0, 20.0, 19.0, 18.0, 17.0, 16.0, 15.0, 14.0, 13.0, 12.0, 11.0, 10.0, 9.0, 8.0, 7.0, 6.0, 5.0, 4.0, 3.0, 2.0, 1.0, 0.2318, 0.231, 0.2238, 0.2232, 0.2231, 0.2221, 0.2215, 0.2197, 0.2193, 0.2176, 0.2171, 0.2165, 0.2164, 0.2146, 0.2142, 0.2142, 0.2131, 0.2128, 0.2128, 0.2128, 0.2124, 0.2122, 0.2112, 0.211, 0.2106, 0.2105, 0.2105, 0.2104, 0.2102, 0.2099, 0.2091, 0.2086, 0.2006, 0.2014, 0.2, 0.1979, 0.1969, 0.2024, 0.1748, 0.2016, 0.1899, 0.191, 0.1834, 0.1538, 0.1915, 0.1819, 0.1163, 0.1367, 0.1773, 0.1373, 0.1547, 0.1122, 0.154, 0.0677, 0.1433, 0.0905, 0.0908, 0.1036, 0.0419, 2.0114, 1.9689, 1.9335, 1.9049, 1.9049, 1.9032, 1.8979, 1.8976, 1.8975, 1.8907, 1.8888, 1.8773, 1.8632, 1.8462, 1.8451, 1.843, 1.8416, 1.8369, 1.8366, 1.8365, 1.8339, 1.827, 1.8234, 1.812, 1.8089, 1.807, 1.8017, 1.798, 1.7909, 1.7854, 1.7778, 1.7507, 1.7133, 1.7545, 1.6557, 1.5334, 1.6263, 1.2267, 1.5409, 1.5298, 1.2594, 1.4686, 1.4184, 1.396, 1.1284, 1.6198, 1.455, 1.4385, 0.2688, -0.0209, 0.5589, 0.8285, 0.8208, 0.3794, 0.82, 0.569, 0.5918, 0.111, -0.2037, 0.1187, 0.5991, 0.586, -0.6202, 0.3341, -0.0803, 0.3974, -0.3782, 0.4061, 0.0232, -0.2298, 0.0276, 0.2613, -0.0012, 3.1106, 3.086, 3.0705, 3.0681, 3.0133, 3.0113, 2.9968, 2.9275, 2.9175, 2.8941, 2.8846, 2.868, 2.8548, 2.8536, 2.8435, 2.8398, 2.8392, 2.831, 2.831, 2.8185, 2.7919, 2.7915, 2.7903, 2.7787, 2.7704, 2.7678, 2.7439, 2.7363, 2.7343, 2.7226, 2.7199, 2.5997, 2.5821, 2.5841, 1.9969, 2.6448, 1.5234, 3.3366, 3.146, 3.0876, 3.0109, 2.9523, 2.9136, 2.8903, 2.8683, 2.8653, 2.7249, 2.6853, 2.6748, 2.6708, 2.6584, 2.6571, 2.6571, 2.6508, 2.6057, 2.5505, 2.5458, 2.5043, 2.4766, 2.4573, 2.3947, 2.391, 2.3274, 2.2114, 2.1648, 2.1185, 2.1045, 2.0136, 1.4599, 1.4205, 0.9088, 0.4532, 0.9723, 3.2501, 3.1002, 3.0463, 3.0456, 2.9391, 2.9295, 2.8722, 2.8626, 2.8401, 2.8225, 2.8148, 2.7539, 2.7029, 2.6676, 2.633, 2.6211, 2.6063, 2.4736, 2.2946, 2.2579, 2.2542, 2.2111, 2.1917, 2.1809, 2.1392, 2.135, 2.1191, 2.1123, 2.0781, 2.0408, 1.5922, 1.6778, 1.1853, 0.9836, 0.5153]}, "token.table": {"Topic": [1, 5, 2, 4, 1, 2, 3, 3, 5, 1, 2, 3, 2, 4, 1, 2, 1, 2, 1, 2, 2, 2, 1, 2, 3, 2, 1, 4, 1, 1, 2, 2, 3, 1, 2, 3, 5, 1, 2, 1, 1, 2, 2, 4, 1, 4, 1, 2, 2, 2, 4, 2, 3, 1, 2, 1, 2, 2, 1, 1, 1, 2, 1, 2, 3, 1, 2, 1, 3, 2, 3, 1, 2, 3, 2, 5, 1, 1, 3, 5, 1, 2, 2, 1, 3, 1, 2, 4, 1, 2, 1, 2, 1, 2, 1, 1, 2, 3, 2, 2, 1, 2, 1, 2, 4, 1, 2, 3, 3, 1, 1, 2, 2, 2, 4, 2, 1, 2, 2, 4, 3, 1, 2, 4, 2, 3, 3, 1, 2, 5, 5, 3, 5, 1, 2, 5, 1, 2, 1, 2, 1, 2, 1, 5, 1, 2, 1, 2, 2, 1, 4, 1, 2, 1, 2, 1, 3, 3, 3, 1, 2, 1, 2, 2, 2, 4, 1, 2, 2, 1, 2, 1, 2, 1, 2, 1, 2, 2, 1, 3, 1, 1, 2, 1, 3, 1, 2, 1, 3, 3, 4, 2, 3, 3, 3, 1, 5, 1, 1, 5, 1, 1, 1, 1, 2, 1, 2, 4, 3, 1, 1, 1, 2, 1, 2, 1, 2, 3, 1, 1, 2, 2, 2, 1, 2, 1, 1, 2, 1, 2, 1, 4, 5, 1, 1, 2, 1, 1, 1, 2, 2, 1, 2, 2, 3, 1, 1, 2, 1, 2, 4, 1, 2, 1, 1, 2, 1, 2, 1, 1, 5, 2, 1, 1, 2, 1, 3, 1, 4, 3, 2, 1, 2, 2, 1, 5, 2, 1, 2, 1, 2, 3, 3], "Freq": [0.805748326116903, 0.4028741630584515, 0.8037270503845603, 0.7735548059624785, 0.3107035345412375, 0.621407069082475, 0.5378909258626742, 0.8098747353353912, 0.8330841385151341, 0.9631031781005908, 0.04586205610002813, 0.7765232746178371, 0.5065340017004749, 0.7955088102038841, 0.8742359392817575, 0.11160458799341585, 0.8995606046063518, 0.09724979509257857, 0.4140339666041842, 0.6210509499062763, 0.8995947846316596, 0.7518851163877502, 0.4905607958424646, 0.4905607958424646, 0.7707362930659989, 0.4976814143272433, 0.9969469146882252, 0.6992678045689241, 0.994121181061536, 0.9546511582607748, 0.02580138265569662, 0.9471300893183574, 0.5200551391196363, 0.4077702715243739, 0.5436936953658318, 0.8187871814923529, 0.7894205185482388, 0.9596794279273381, 0.02822586552727465, 0.8375041724247831, 0.9572209319550276, 0.023930523298875687, 0.9410905992627241, 0.6830098561031258, 0.78721197482447, 0.26240399160815664, 0.8005524169174825, 0.1906077183136863, 0.6766435724413117, 0.6316465981836884, 0.7169556871697244, 0.9020707069703742, 0.5967690414868871, 0.9311288633218445, 0.04775019811906895, 0.35350137550558186, 0.7070027510111637, 0.6851525698417132, 0.8268915845819771, 0.9419831512362984, 0.95399491025502, 0.035333144824260004, 0.9436833756870643, 0.03370297770310944, 0.8749800785322202, 0.5657218422642636, 0.4400058773166494, 0.1560955367428114, 0.7804776837140571, 0.1626668369663536, 0.813334184831768, 0.9618432420652161, 0.04691918253976664, 0.6517858446662008, 0.8391244517906907, 0.7305193627353767, 0.9919786823741679, 0.9503730453520266, 0.7212932735014838, 0.528914376031159, 0.8435069120116097, 0.14058448533526827, 0.9511409363154182, 0.6478441633524996, 0.5467913506341985, 0.7115660559367026, 0.2541307342631081, 0.6073779330690954, 0.7832805217748978, 0.23037662405144055, 0.9486801659632838, 0.05580471564489904, 0.8658144457026494, 0.12368777795752135, 0.7517798122072958, 0.5088766843990581, 0.5088766843990581, 0.8161159797616075, 0.4955364538169879, 0.791363969124911, 0.9309116625096964, 0.060336867014517355, 0.9228274823711623, 0.07482384992198614, 0.7243950528439684, 0.8788847251472752, 0.11425501426914578, 0.7427680495848872, 0.8639887996660548, 0.9696967575182359, 0.4892343974173219, 0.4892343974173219, 0.9132427112531016, 0.4998243023220509, 0.9334495649618267, 0.7620555281862869, 0.945791235320249, 0.05404521344687137, 0.7027322712498215, 0.9470504212956244, 0.572370493158351, 0.7796398812061839, 0.11137712588659769, 0.6623598630158851, 0.65177615374131, 0.739646987877017, 0.8360374157810697, 0.8729910600247606, 0.10912388250309507, 0.9166239882520947, 0.6771681083770502, 0.4561449128106959, 0.7908590941760563, 0.8919313075160963, 0.10341232550911261, 0.7328106580903928, 0.7895540152960567, 0.2125722348873999, 0.7685299891821039, 0.2260382321123835, 0.8422480974792417, 0.15040144597843602, 0.9769013593470558, 0.6051234825923177, 0.979716279429617, 0.025120930241785053, 0.8627397454873655, 0.12324853506962365, 0.6487873748875842, 0.6071978094807998, 0.6071978094807998, 0.1985310717829687, 0.5955932153489061, 0.9627863830373249, 0.029175344940524997, 0.9486532582593522, 0.7449449198748853, 0.8095673966692971, 0.6491635598470231, 0.9612847105011568, 0.0468919370976174, 0.7189730818758299, 0.2567761006699392, 0.829111063487536, 0.8834810311980399, 0.5915436022663301, 0.24151636848015462, 0.7245491054404638, 0.8321933940313794, 0.8047004376976699, 0.1828864631131068, 0.8237305728173734, 0.17161053600361945, 0.892203239336879, 0.09104114687111009, 0.9654802919329425, 0.026094061944133582, 0.7103165236026958, 0.6938219798729219, 0.23127399329097398, 0.7786833051197322, 0.9435713291134193, 0.05100385562775239, 0.9659000807894353, 0.6256325796516126, 0.4225763930531393, 0.5282204913164241, 0.5929208594940646, 0.2964604297470323, 0.7986566467531414, 0.5432940634550657, 0.7257112353582695, 0.7171001547959652, 0.7633412641613534, 0.8596487541766009, 0.9905447584324111, 0.8723928694469736, 0.7408060042668775, 0.9717025276610128, 0.8474573600171829, 0.9601736233999465, 0.9646191074828042, 0.9699542596471994, 0.9250212858132116, 0.06768448432779597, 0.8537005989378145, 0.12805508984067218, 0.7398485034534212, 0.5423408582851088, 0.9671345196980029, 0.9799126086682349, 0.47507418320164435, 0.47507418320164435, 0.23455505272247268, 0.703665158167418, 0.7211188338523978, 0.2773533976355376, 0.765360657583581, 0.9878338606900687, 0.9605929981998449, 0.0320197666066615, 0.8908245635618065, 0.8263728247674313, 0.765646370691823, 0.2296939112075469, 0.9413410711693946, 0.9486810868257929, 0.9477626430755194, 0.6040765514652281, 0.36244593087913685, 0.9600571067248932, 0.7758058650460359, 0.8238400929162428, 0.951438236000597, 0.5900221151752049, 0.19667403839173495, 0.995573724051295, 0.5617057561298732, 0.8097772621351595, 0.18509194563089362, 0.49825610742162385, 0.5939994634077347, 0.4242853310055248, 0.543183482782424, 0.543183482782424, 0.9943794544611709, 0.9602312827980356, 0.03200770942660119, 0.7851432318612431, 0.21809534218367865, 0.9430931572654644, 0.8753274794168072, 0.12872462932600107, 0.8493746289850128, 0.9143760008711541, 0.08068023537098418, 0.25623268797847437, 0.7686980639354231, 0.9678091140676507, 0.7194311495632197, 0.23981038318773992, 0.7428135840192662, 0.733303510197467, 0.9358271318764645, 0.046791356593823226, 0.597974912084489, 0.8471405332200242, 0.9576073156275963, 0.680227436635127, 0.6779295804987822, 0.914553155740941, 0.9509692861333852, 0.028817251094951066, 0.9341097170027011, 0.9695865307464321, 0.5713984066984652, 0.8860600665525235, 0.8335748264471482, 0.16671496528942964, 0.3152689235708797, 0.6305378471417594, 0.7375836073978171, 0.5949394993878613], "Term": ["ac", "ac", "airline", "amc", "asada", "asada", "aunt", "awsome", "baiz", "bar", "bar", "battery", "beet", "bertha", "best", "best", "better", "better", "bike", "bike", "biz", "boba", "book", "book", "bosa", "bowling", "bread", "breadstick", "breakfast", "burger", "burger", "camelback", "caring", "carne", "carne", "carpet", "chalet", "cheese", "cheese", "cheesy", "chicken", "chicken", "chino", "cigar", "classy", "classy", "clean", "clean", "clothing", "contemporary", "cough", "curd", "defiantly", "delicious", "delicious", "dentist", "dentist", "department", "despite", "dessert", "dinner", "dinner", "dish", "dish", "doctor", "dog", "dog", "donut", "donut", "dr", "dr", "drink", "drink", "duke", "dvd", "earl", "egg", "enjoyed", "estimate", "ethiopian", "exactly", "exactly", "exchange", "exit", "fabric", "fast", "fast", "film", "free", "free", "friend", "friend", "friendly", "friendly", "frosty", "frozen", "frozen", "fru", "gel", "german", "good", "good", "got", "got", "gras", "great", "great", "groomed", "groomers", "group", "hair", "hair", "haircut", "hall", "hateful", "hike", "hour", "hour", "http", "imax", "insurance", "interesting", "interesting", "jennifer", "jim", "jones", "kang", "know", "know", "ladybug", "lee", "lesson", "lifter", "like", "like", "lite", "location", "location", "looking", "looking", "love", "love", "loved", "lox", "lunch", "lunch", "make", "make", "mani", "mart", "mart", "massage", "massage", "meal", "meal", "meat", "mechanic", "medal", "medical", "menu", "menu", "mexican", "mexican", "mission", "mole", "moore", "mountain", "mountain", "nail", "need", "need", "new", "new", "nice", "nice", "night", "night", "nordstrom", "older", "older", "oooh", "order", "order", "ordered", "organ", "park", "park", "patient", "patient", "pb", "pedi", "pedicure", "physical", "physician", "pischke", "pizza", "plantation", "plastic", "plate", "plumbing", "pork", "portion", "potato", "pretty", "pretty", "price", "price", "reported", "reviewed", "roll", "salad", "sale", "sale", "salon", "salon", "salsa", "salsa", "sandbar", "sandwich", "sauce", "sauce", "scott", "security", "selection", "selection", "served", "server", "shoe", "shop", "shop", "shrimp", "sneaker", "society", "soup", "spectacular", "spectacular", "spicy", "spotless", "staff", "staff", "steve", "store", "store", "surgery", "surgery", "sushi", "table", "table", "taco", "taco", "theater", "thing", "thing", "thinking", "time", "time", "tire", "tire", "tomato", "tour", "tour", "trail", "treated", "try", "try", "vast", "vet", "waitress", "wal", "wally", "wander", "went", "went", "wifi", "wine", "winning", "www", "year", "year", "yogurt", "yogurt", "yogurtology", "zoo"]}, "R": 30, "lambda.step": 0.01, "plot.opts": {"xlab": "PC1", "ylab": "PC2"}, "topic.order": [1, 2, 3, 5, 4]};

function LDAvis_load_lib(url, callback){
  var s = document.createElement('script');
  s.src = url;
  s.async = true;
  s.onreadystatechange = s.onload = callback;
  s.onerror = function(){console.warn("failed to load library " + url);};
  document.getElementsByTagName("head")[0].appendChild(s);
}

if(typeof(LDAvis) !== "undefined"){
   // already loaded: just create the visualization
   !function(LDAvis){
       new LDAvis("#" + "ldavis_el50902110807382723060654481", ldavis_el50902110807382723060654481_data);
   }(LDAvis);
}else if(typeof define === "function" && define.amd){
   // require.js is available: use it to load d3/LDAvis
   require.config({paths: {d3: "https://d3js.org/d3.v5"}});
   require(["d3"], function(d3){
      window.d3 = d3;
      LDAvis_load_lib("https://cdn.jsdelivr.net/gh/bmabey/pyLDAvis@3.4.0/pyLDAvis/js/ldavis.v3.0.0.js", function(){
        new LDAvis("#" + "ldavis_el50902110807382723060654481", ldavis_el50902110807382723060654481_data);
      });
    });
}else{
    // require.js not available: dynamically load d3 & LDAvis
    LDAvis_load_lib("https://d3js.org/d3.v5.js", function(){
         LDAvis_load_lib("https://cdn.jsdelivr.net/gh/bmabey/pyLDAvis@3.4.0/pyLDAvis/js/ldavis.v3.0.0.js", function(){
                 new LDAvis("#" + "ldavis_el50902110807382723060654481", ldavis_el50902110807382723060654481_data);
            })
         });
}
</script>
</div>
</div>
</section>
</section>
<section id="topic-modeling-for-negative-reviews" class="level3">
<h3 class="anchored" data-anchor-id="topic-modeling-for-negative-reviews">Topic Modeling for Negative Reviews</h3>
<div id="a61d6620" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Topic Modeling for Negative Reviews</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>lda_negative <span class="op">=</span> LatentDirichletAllocation(n_components<span class="op">=</span>n_topics, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>lda_negative.fit(negative_tfidf)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the topics for negative reviews</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Negative Reviews Topics:"</span>)</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>tf_feature_names_negative <span class="op">=</span> vectorizer_negative.get_feature_names_out()</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>display_topics(lda_negative, tf_feature_names_negative, n_top_words)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Negative Reviews Topics:
Topic #1:
work lot think order friend thing staff car like guy

Topic #2:
closed time like bad china night priced chicken star average

Topic #3:
chicken good sauce time review customer say like item cheese

Topic #4:
chicken time table drink like good bad meal slow went

Topic #5:
like time bad horrible minute shop friend come wait store
</code></pre>
</div>
</div>
<section id="visualizing-negative-reviews" class="level4">
<h4 class="anchored" data-anchor-id="visualizing-negative-reviews">Visualizing Negative Reviews</h4>
<div id="5ce1af2e" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare the LDA visualization for negative reviews</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>panel_negative <span class="op">=</span> pyLDAvis.lda_model.prepare(lda_negative, negative_tfidf, vectorizer_negative)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"LDA Visualization for Negative Reviews"</span>)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>pyLDAvis.display(panel_negative)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>LDA Visualization for Negative Reviews</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="45">

<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/bmabey/pyLDAvis@3.4.0/pyLDAvis/js/ldavis.v1.0.0.css">


<div id="ldavis_el50902110807445446688751285" style="background-color:white;"></div>
<script type="text/javascript">

var ldavis_el50902110807445446688751285_data = {"mdsDat": {"x": [0.0187155826610063, 0.0062565547519145065, -0.019447726147200584, -0.0035574174892389295, -0.00196699377648129], "y": [-0.01145906115936129, 0.0030558433381805694, -0.013720514383670604, 0.017587519201043143, 0.004536213003808174], "topics": [1, 2, 3, 4, 5], "cluster": [1, 1, 1, 1, 1], "Freq": [25.444475804973244, 21.65395210147463, 18.098878852331637, 17.596182276586227, 17.20651096463425]}, "tinfo": {"Term": ["closed", "china", "good", "priced", "chicken", "table", "beef", "stop", "sauce", "meal", "brittle", "chinese", "desk", "item", "ok", "nasty", "tasteless", "circle", "honey", "walked", "train", "love", "slow", "coffee", "night", "donut", "worker", "cold", "store", "visit", "soda", "coffee", "bandaid", "hair", "damn", "turd", "starting", "best", "casual", "weekend", "checked", "teppenyaki", "olive", "dozen", "shop", "ask", "strange", "mediocre", "fb", "discouraged", "store", "selection", "amazing", "rotisserie", "income", "panang", "puri", "margarita", "shelf", "bra", "eating", "fast", "bring", "window", "horrible", "decent", "worse", "buy", "wait", "like", "minute", "expensive", "come", "friend", "month", "decided", "time", "beer", "bad", "told", "awful", "eat", "great", "experience", "think", "employee", "make", "going", "salad", "day", "chicken", "good", "bar", "want", "say", "beef", "brewpub", "legit", "low", "expierence", "downhill", "pita", "arrived", "stale", "clean", "hungry", "junk", "law", "cummings", "craving", "add", "mistake", "mold", "pretend", "slow", "regret", "cricket", "finished", "table", "enjoyed", "meal", "email", "soup", "sink", "unfortunately", "curry", "drink", "scottsdale", "stay", "recommend", "burger", "husband", "business", "took", "server", "rude", "chicken", "fry", "green", "went", "time", "good", "bad", "like", "bar", "experience", "sandwich", "way", "getting", "menu", "review", "eat", "guy", "customer", "ordered", "china", "desk", "closed", "whinings", "meh", "consistently", "stop", "taxi", "ringing", "nasty", "course", "generally", "train", "worker", "priced", "trail", "walked", "prompt", "panini", "caught", "obsessed", "brownie", "created", "host", "despite", "warmed", "accept", "cold", "perfection", "professional", "cooking", "ended", "portion", "burrito", "night", "min", "office", "idea", "atmosphere", "average", "time", "long", "money", "love", "maybe", "bad", "sandwich", "like", "star", "ordered", "visit", "chicken", "people", "location", "got", "make", "beer", "wrong", "brittle", "honey", "dilly", "bear", "chinese", "tasteless", "tax", "horribly", "unbelievable", "loss", "lately", "mmmmmm", "serf", "waste", "monroe", "truly", "valuable", "lush", "high", "easy", "hockey", "lgo", "land", "machaca", "changing", "cookie", "bourbon", "insanity", "kentucky", "cashew", "item", "sauce", "ok", "good", "piece", "finger", "chicken", "pork", "review", "customer", "cheese", "say", "noodle", "different", "wine", "menu", "gave", "disappointed", "time", "dish", "ordered", "like", "look", "going", "want", "better", "order", "bad", "bland", "thing", "salad", "circle", "target", "outside", "chandler", "chomping", "overdone", "loco", "moco", "wear", "snobby", "tomasos", "latte", "touch", "blaming", "tacky", "bento", "puking", "fix", "tonight", "david", "kokopellis", "qdoba", "turn", "barber", "mystery", "supreme", "spaghetti", "gum", "information", "brand", "book", "work", "lot", "bit", "donut", "car", "mall", "reviewer", "airport", "old", "family", "huge", "staff", "think", "thing", "friend", "need", "order", "try", "guy", "cream", "day", "probably", "way", "area", "disappointed", "going", "door", "want", "meat", "star", "like", "chicken", "wrong", "know", "got", "time"], "Freq": [1.0, 0.0, 2.0, 0.0, 2.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.39633297233241893, 0.5430706983687942, 0.3372185897973334, 0.3036346566713555, 0.34854125396113533, 0.2805135311282657, 0.2939616572703161, 0.366525683154274, 0.30684952045066194, 0.26487062471572004, 0.33464098383004165, 0.2635885736813815, 0.259674314519056, 0.25882940769873747, 0.5639271519472162, 0.4506697014202441, 0.2568553287582714, 0.5045080318591596, 0.25104386650958777, 0.24460159991356525, 0.5475608164755774, 0.49363671001243437, 0.2550944181187094, 0.2343929003661074, 0.2334465100909688, 0.23054928201935357, 0.22958452319123143, 0.3349817665400155, 0.22830762792248344, 0.2281079222102314, 0.4143813740716813, 0.28099740147997976, 0.3245238129395473, 0.3061582619867881, 0.6687390868738828, 0.4343436326569359, 0.38270798620413626, 0.3364296443121712, 0.5475859250989947, 1.074150650015489, 0.5938471810169408, 0.40766046319882265, 0.5552540040206393, 0.5638636732187275, 0.3876405561142224, 0.39452663069434873, 0.79390045333354, 0.44868865888918597, 0.677040883731788, 0.46751458984101407, 0.4918493868822814, 0.4869253908120967, 0.4780949671092522, 0.46533739572761895, 0.4975259778616742, 0.4152901286573068, 0.4760632974114683, 0.46062550005926556, 0.43971833343131334, 0.43982043072370963, 0.4934540450378915, 0.4653961455277418, 0.43129052098278997, 0.4309978788023566, 0.4337996583529796, 0.47347735609905, 0.29002920885801664, 0.29002920885801664, 0.35542029434466843, 0.28349534083884476, 0.28146633594050435, 0.274298079640858, 0.2826712103989564, 0.23333479571919596, 0.3903351834332074, 0.22040635550761503, 0.2383128717017285, 0.21596034315130422, 0.21465799538659325, 0.20970540062450468, 0.2886541517164364, 0.338293533236567, 0.20624668806921406, 0.24470110878748977, 0.5159729176844767, 0.20400169851202354, 0.20320993611924465, 0.2309141811352399, 0.6369034000429937, 0.25745839635619056, 0.573162459314914, 0.19792783556921276, 0.27793528222802893, 0.19388295471498465, 0.3662935146329973, 0.2950672650893501, 0.6118205689089488, 0.3152012884996314, 0.4159318673517647, 0.3071799183887592, 0.44779123746351013, 0.32118923080424017, 0.47753184159562273, 0.41161561698867016, 0.3395631059261572, 0.4303749130454121, 0.8147692937739963, 0.34641236509649614, 0.39013536109583835, 0.4894693390832512, 0.6713591945205167, 0.5894436141232932, 0.5872361744315857, 0.6063454149415728, 0.4204846070453225, 0.41166158890614357, 0.41650823915317353, 0.42901873293230236, 0.3652924573505891, 0.37057121397921955, 0.41023167302463664, 0.37235349012640173, 0.3671918783983329, 0.3697915640865335, 0.36781669547144796, 0.46864968090469955, 0.3034803358742947, 0.6961178665333092, 0.25146535286083377, 0.2467682805469887, 0.2415901496593391, 0.37720732491165815, 0.22731858474695685, 0.22411843575632015, 0.3588111433069656, 0.28149190797630264, 0.25178260621455534, 0.278385272983891, 0.3151278449546983, 0.4210745731699911, 0.20346747546333388, 0.36151060019801673, 0.1968577168862221, 0.19634678177487702, 0.19175807878869844, 0.19111732904576076, 0.2383220576290092, 0.18871391363671774, 0.18628958938521453, 0.25743213005771204, 0.18439462217921204, 0.18427156190062105, 0.321966521636481, 0.20323270232826288, 0.1818288817308021, 0.22255021537509795, 0.30299029174920933, 0.29497057634685675, 0.31178106398141, 0.4468476076664855, 0.27316020321761786, 0.24499010879244518, 0.2736965888785795, 0.25681759290582296, 0.3799523077962127, 0.6394102274019057, 0.35081417692387573, 0.3182121768123486, 0.33027602807977674, 0.34862045517161827, 0.5121631304373873, 0.37602706042776246, 0.5453413985293625, 0.3802946663884146, 0.3714892932718016, 0.29852819979545664, 0.3925761697722356, 0.32431900156094906, 0.32585553694187885, 0.3332580715681979, 0.32413593533344576, 0.306330569738365, 0.31040040884142006, 0.29848538822719495, 0.3023497579343934, 0.24053733271219166, 0.23136871419642766, 0.3466038716097046, 0.323459188061433, 0.2242183369269905, 0.22054668530380234, 0.21853030536785237, 0.21497531879197, 0.20501181621683404, 0.2023858940551594, 0.1903799254661891, 0.25647442459929076, 0.17929526404315962, 0.17929526404315962, 0.17929526404315962, 0.17751956926694382, 0.32098048456983547, 0.23024382242666272, 0.17568032338646225, 0.17231196421495898, 0.1699595234890567, 0.1699595234890567, 0.16907475361176488, 0.1689000851060653, 0.16827522585796503, 0.16827522585796503, 0.16827522585796503, 0.16815364454204257, 0.38940239479677474, 0.5421239874300978, 0.327259671124487, 0.7668585180465013, 0.25801784236652564, 0.22146615463815578, 0.8114909449728639, 0.21927028660668363, 0.48226305217844423, 0.460201882530205, 0.38335777565519225, 0.4496584474295431, 0.24515876515133178, 0.3061585628247325, 0.23142612787577352, 0.33429291056956645, 0.2886250911383956, 0.3351893289985708, 0.49854089161351306, 0.2940764713644564, 0.35136373025347845, 0.44096334181586694, 0.29237752947370876, 0.33367470164809454, 0.31512385001252685, 0.2964994761305003, 0.32631098796154545, 0.3539045045483881, 0.27831334840171684, 0.3021504812607884, 0.2926961560604582, 0.27432165297202193, 0.20909564994165603, 0.2529852942213375, 0.18645619143833958, 0.18111363360951072, 0.18111363360951072, 0.17977152684567824, 0.17977152684567824, 0.1788879390138483, 0.17823022779118233, 0.17823022779118233, 0.21084439775876693, 0.16742844165199539, 0.16670152659088008, 0.16670152659088008, 0.16581378433053698, 0.16513794272253368, 0.18191416245330727, 0.20669479399511004, 0.16130016352383134, 0.15993204826213547, 0.15993204826213547, 0.1705625185758222, 0.20410041450249422, 0.15361721155670582, 0.15361721155670582, 0.1701660757769296, 0.17283969118517906, 0.15048928035478712, 0.1790497628878093, 0.2714500035266045, 0.40026575639795836, 0.380655035144573, 0.3090028825286024, 0.285382811696233, 0.32426208468683093, 0.25481407142758333, 0.2042056146704752, 0.2640829725277677, 0.2509066601455667, 0.21958606843600537, 0.19268476829161496, 0.3315015438044435, 0.3588698894678, 0.3400978543209168, 0.34340401242922636, 0.2996095239118528, 0.35721321445071197, 0.29896067583052993, 0.31158689664569694, 0.23694616310516622, 0.2942968159610321, 0.22908575380707655, 0.2932933318417849, 0.24869192574266458, 0.25894544422817267, 0.2818907056515435, 0.2509134048421333, 0.2669056385715777, 0.2450931791766956, 0.2676891290037178, 0.31414682537326216, 0.30051520974903095, 0.25729160390073297, 0.26008056197159013, 0.2601942972259969, 0.2657343840317456], "Total": [1.0, 0.0, 2.0, 0.0, 2.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.6277622194598569, 0.8998446892931105, 0.5686490465037927, 0.549288260921361, 0.6306465610562629, 0.5119379500308987, 0.5401160175878801, 0.6783145636057696, 0.5729596365416998, 0.49629529211361173, 0.6271962121273642, 0.49502758226958027, 0.4910975014116299, 0.4902544990052784, 1.0700311841095829, 0.8592695460901594, 0.4906041152583323, 0.9668171175715041, 0.4824720836351887, 0.4760298975518807, 1.0678051342331147, 0.9699569860425012, 0.5033555682655407, 0.46581869130994574, 0.4648707368226347, 0.4619836554216936, 0.4610102352661298, 0.6731022095814281, 0.45973469701238034, 0.45953531335510484, 0.8490309155505922, 0.5690084799051812, 0.6639566046525456, 0.6246102906267639, 1.4448318521780168, 0.9145466322071065, 0.796224766534582, 0.6990192602321791, 1.2843426183552415, 2.980947630675553, 1.442420133659129, 0.9200721616334372, 1.4548528742178628, 1.4891524322973875, 0.8716495528473283, 0.8971648322014916, 2.868945150901221, 1.1297481750383738, 2.3556258723061774, 1.249655608231325, 1.4086360375939995, 1.4236076406326073, 1.3840794316422527, 1.315391620284218, 1.575679375503317, 1.0521695309717454, 1.58664845532004, 1.567976396827012, 1.3499801077089475, 1.4257375624628104, 2.812805663306018, 2.335668242056528, 1.3632428800170229, 1.385063842536617, 1.5768789382521344, 0.7837008777269229, 0.5281058713458524, 0.5281058713458524, 0.6504988127997771, 0.5215542538233309, 0.5195315661663603, 0.5123446062467322, 0.5642777744332792, 0.4713858299993803, 0.8112789312346231, 0.45845315901308875, 0.49600576955645365, 0.4540115938846406, 0.4527067720700688, 0.4477636240638354, 0.6200029867568134, 0.727356079843152, 0.44429433146410335, 0.527434282511483, 1.1175283456942287, 0.4420526158199049, 0.4412573044635538, 0.5014376824937865, 1.3877574886635167, 0.5623740454434699, 1.2527055480378375, 0.4359750385569259, 0.616607552524849, 0.43193118750012305, 0.8166788787325869, 0.6593098831931024, 1.4027988078363547, 0.7074718893955954, 0.9841533648750719, 0.7052056788395573, 1.1028028242944141, 0.7478067364087785, 1.2279096983221875, 1.0331667080221505, 0.8093533333408081, 1.1538853161431977, 2.812805663306018, 0.8762377079478622, 1.054065851813308, 1.5203002656749776, 2.868945150901221, 2.335668242056528, 2.3556258723061774, 2.980947630675553, 1.3632428800170229, 1.315391620284218, 1.3610589690547652, 1.5363937688755058, 1.0290731390034324, 1.1435978459645038, 1.6167596125823684, 1.4236076406326073, 1.3674946351851835, 1.5689141822434531, 1.6315142610485498, 0.8387496712098165, 0.5493005278012497, 1.3446395052263767, 0.49701512485404237, 0.49230192241472204, 0.4871241688946291, 0.7669671487064561, 0.47310818872923566, 0.46965361800051825, 0.7582348716904879, 0.597666150949787, 0.5366814576089157, 0.6015821235479097, 0.6815295566417647, 0.9119741207366446, 0.44900073477952945, 0.8035663749395243, 0.4423962979117259, 0.4418750098092835, 0.43731350297790583, 0.43665297492488303, 0.5454429656336405, 0.4342537428540604, 0.4318211329760582, 0.598048698912616, 0.42993515358088275, 0.42980217341939775, 0.7543691345301571, 0.47703544364605677, 0.4273601088364495, 0.5306285327300825, 0.7757184017161723, 0.7525374590366902, 0.8174648704329353, 1.3622274206485674, 0.7121745480094404, 0.617651453261316, 0.7284467730757291, 0.6644675410172451, 1.2368088520985296, 2.868945150901221, 1.1179646788999351, 0.9540400718142311, 1.0179205499800765, 1.1371380844575834, 2.3556258723061774, 1.3610589690547652, 2.980947630675553, 1.4432817075967428, 1.6315142610485498, 0.9426015658881958, 2.812805663306018, 1.3716148737451215, 1.441684247917215, 1.5870914899229496, 1.58664845532004, 1.1297481750383738, 1.2839041785238525, 0.5447105101978236, 0.6086519776118612, 0.48675401576624805, 0.4775806588900669, 0.716674813212904, 0.6776798503516204, 0.47043369494860515, 0.46675768704175896, 0.4647416497998891, 0.46119654683294664, 0.4512248982588213, 0.4485969054112039, 0.43658968833133505, 0.5902228706807156, 0.42551660108510614, 0.42551660108510614, 0.42551660108510614, 0.42373293544415386, 0.7662244753726614, 0.5527067470251185, 0.42188899540007696, 0.41851906663811894, 0.41618180070990085, 0.41618180070990085, 0.41529283719548904, 0.41510705259432124, 0.4144949900513043, 0.4144949900513043, 0.4144949900513043, 0.4143809094420309, 0.9679665484193835, 1.4192160659575517, 0.8719368205211827, 2.335668242056528, 0.6785200450607983, 0.5750413289815544, 2.812805663306018, 0.5767165828003513, 1.6167596125823684, 1.5689141822434531, 1.2414970431727184, 1.5768789382521344, 0.6701228772818769, 0.9623184006573955, 0.6286233683987573, 1.1435978459645038, 0.9060848103023231, 1.1824663465036394, 2.868945150901221, 1.0230633430231788, 1.6315142610485498, 2.980947630675553, 1.0600636831908654, 1.567976396827012, 1.385063842536617, 1.148057764843381, 1.681496519400608, 2.3556258723061774, 0.9640387785485335, 1.4565699434708712, 1.3499801077089475, 0.5211423004357104, 0.4559105353968415, 0.5852289656049185, 0.43327095026724904, 0.42793899798562074, 0.42793899798562074, 0.4265966976856566, 0.4265966976856566, 0.4257031850981188, 0.42505016128578055, 0.42505016128578055, 0.5062247853745805, 0.41424528077877676, 0.41352464067986244, 0.41352464067986244, 0.4126270866160595, 0.41195106044988294, 0.45503611021159196, 0.5225056767318992, 0.4081200054891184, 0.4067493395302512, 0.4067493395302512, 0.4365448306304742, 0.5262959760513974, 0.40044114283177895, 0.40044114283177895, 0.44398152982889877, 0.45363402470300224, 0.3973038827836911, 0.4766275304508396, 0.7388002704148651, 1.2134057121841209, 1.1601943373247265, 0.9243117823218466, 0.8442208453387114, 0.9965100666298943, 0.7365866670100765, 0.5606748992654778, 0.7971191674127941, 0.7581615443144256, 0.6490120437672465, 0.5279502532369302, 1.3114709686520123, 1.575679375503317, 1.4565699434708712, 1.4891524322973875, 1.180610358924802, 1.681496519400608, 1.2149327758924613, 1.3674946351851835, 0.7705806405885597, 1.4257375624628104, 0.7732583355424127, 1.5363937688755058, 1.0374885410317218, 1.1824663465036394, 1.567976396827012, 1.070302760328033, 1.385063842536617, 1.0009223403402943, 1.4432817075967428, 2.980947630675553, 2.812805663306018, 1.2839041785238525, 1.4042547280664777, 1.5870914899229496, 2.868945150901221], "Category": ["Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Default", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic1", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic2", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic3", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic4", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5", "Topic5"], "logprob": [30.0, 29.0, 28.0, 27.0, 26.0, 25.0, 24.0, 23.0, 22.0, 21.0, 20.0, 19.0, 18.0, 17.0, 16.0, 15.0, 14.0, 13.0, 12.0, 11.0, 10.0, 9.0, 8.0, 7.0, 6.0, 5.0, 4.0, 3.0, 2.0, 1.0, -6.9627, -6.6477, -7.1242, -7.2291, -7.0912, -7.3083, -7.2615, -7.0409, -7.2186, -7.3657, -7.1319, -7.3705, -7.3855, -7.3888, -6.61, -6.8342, -7.3964, -6.7213, -7.4193, -7.4453, -6.6394, -6.7431, -7.4033, -7.4879, -7.492, -7.5045, -7.5086, -7.1308, -7.5142, -7.5151, -6.9181, -7.3066, -7.1626, -7.2208, -6.4395, -6.8711, -6.9976, -7.1265, -6.6394, -5.9656, -6.5583, -6.9345, -6.6255, -6.6101, -6.9848, -6.9672, -6.268, -6.8386, -6.4272, -6.7975, -6.7467, -6.7568, -6.7751, -6.8022, -6.7353, -6.9159, -6.7794, -6.8123, -6.8588, -6.8586, -6.7435, -6.802, -6.8781, -6.8788, -6.8723, -6.6235, -7.1136, -7.1136, -6.9103, -7.1364, -7.1436, -7.1694, -7.1393, -7.3311, -6.8166, -7.3881, -7.31, -7.4085, -7.4146, -7.4379, -7.1184, -6.9597, -7.4545, -7.2836, -6.5376, -7.4655, -7.4694, -7.3416, -6.327, -7.2328, -6.4324, -7.4957, -7.1562, -7.5164, -6.8802, -7.0964, -6.3672, -7.0304, -6.7531, -7.0562, -6.6793, -7.0116, -6.615, -6.7635, -6.9559, -6.719, -6.0807, -6.936, -6.8171, -6.5903, -6.2743, -6.4044, -6.4082, -6.3762, -6.7422, -6.7634, -6.7517, -6.7221, -6.8829, -6.8686, -6.7669, -6.8638, -6.8777, -6.8707, -6.876, -6.4544, -6.889, -6.0588, -7.077, -7.0958, -7.117, -6.6715, -7.1779, -7.1921, -6.7215, -6.9642, -7.0757, -6.9753, -6.8513, -6.5615, -7.2888, -6.714, -7.3218, -7.3244, -7.348, -7.3514, -7.1306, -7.364, -7.377, -7.0535, -7.3872, -7.3879, -6.8298, -7.2899, -7.4012, -7.1991, -6.8906, -6.9174, -6.862, -6.5021, -6.9942, -7.1031, -6.9923, -7.0559, -6.6642, -6.1437, -6.744, -6.8416, -6.8043, -6.7503, -6.3656, -6.6746, -6.3029, -6.6633, -6.6868, -6.9054, -6.6315, -6.8225, -6.8178, -6.7954, -6.8231, -6.8796, -6.8664, -6.8774, -6.8645, -7.0932, -7.1321, -6.7279, -6.797, -7.1635, -7.18, -7.1892, -7.2056, -7.253, -7.2659, -7.3271, -7.0291, -7.3871, -7.3871, -7.3871, -7.397, -6.8047, -7.137, -7.4074, -7.4268, -7.4405, -7.4405, -7.4458, -7.4468, -7.4505, -7.4505, -7.4505, -7.4512, -6.6115, -6.2806, -6.7853, -5.9338, -7.0231, -7.1758, -5.8772, -7.1858, -6.3976, -6.4444, -6.6271, -6.4676, -7.0742, -6.852, -7.1318, -6.7641, -6.911, -6.7614, -6.3644, -6.8923, -6.7143, -6.4871, -6.8981, -6.7659, -6.8231, -6.8841, -6.7883, -6.7071, -6.9474, -6.8652, -6.897, -6.9394, -7.2109, -7.0204, -7.3255, -7.3546, -7.3546, -7.362, -7.362, -7.367, -7.3706, -7.3706, -7.2026, -7.4332, -7.4375, -7.4375, -7.4428, -7.4469, -7.3502, -7.2225, -7.4704, -7.479, -7.479, -7.4146, -7.2351, -7.5192, -7.5192, -7.4169, -7.4013, -7.5398, -7.366, -6.9499, -6.5616, -6.6118, -6.8204, -6.8999, -6.7722, -7.0132, -7.2346, -6.9774, -7.0286, -7.162, -7.2927, -6.7501, -6.6707, -6.7245, -6.7148, -6.8512, -6.6754, -6.8534, -6.812, -7.0859, -6.8691, -7.1196, -6.8725, -7.0375, -6.9971, -6.9122, -7.0286, -6.9668, -7.0521, -6.9639, -6.8038, -6.8482, -7.0035, -6.9927, -6.9923, -6.9712], "loglift": [30.0, 29.0, 28.0, 27.0, 26.0, 25.0, 24.0, 23.0, 22.0, 21.0, 20.0, 19.0, 18.0, 17.0, 16.0, 15.0, 14.0, 13.0, 12.0, 11.0, 10.0, 9.0, 8.0, 7.0, 6.0, 5.0, 4.0, 3.0, 2.0, 1.0, 0.9088, 0.8637, 0.8461, 0.7759, 0.7757, 0.7671, 0.7603, 0.7531, 0.7442, 0.7407, 0.7405, 0.7384, 0.7315, 0.7299, 0.7282, 0.7233, 0.7215, 0.7182, 0.7154, 0.7028, 0.7008, 0.6932, 0.689, 0.6819, 0.6799, 0.6736, 0.6715, 0.6709, 0.6687, 0.6683, 0.6514, 0.6631, 0.6528, 0.6556, 0.5983, 0.6241, 0.6361, 0.6374, 0.5162, 0.348, 0.4812, 0.5547, 0.4054, 0.3975, 0.5584, 0.5471, 0.0839, 0.4453, 0.1218, 0.3855, 0.3165, 0.2958, 0.3057, 0.3295, 0.2159, 0.439, 0.1648, 0.1437, 0.247, 0.1926, -0.3718, -0.2445, 0.2178, 0.2013, 0.0781, 1.0261, 0.9307, 0.9307, 0.9255, 0.9204, 0.9171, 0.9052, 0.8387, 0.8268, 0.7984, 0.7976, 0.797, 0.787, 0.7838, 0.7714, 0.7655, 0.7645, 0.7626, 0.762, 0.7572, 0.7567, 0.7546, 0.7545, 0.7512, 0.7487, 0.7481, 0.7403, 0.7331, 0.729, 0.7282, 0.726, 0.7002, 0.7215, 0.6687, 0.6989, 0.6287, 0.6849, 0.5855, 0.6097, 0.6614, 0.5437, 0.2909, 0.602, 0.5361, 0.3966, 0.0776, 0.1531, 0.1408, -0.0626, 0.3538, 0.3683, 0.3459, 0.2543, 0.4943, 0.4031, 0.1585, 0.1889, 0.2151, 0.0848, 0.0403, 1.1273, 1.116, 1.051, 1.028, 1.0187, 1.008, 0.9997, 0.9763, 0.9695, 0.9611, 0.9564, 0.9525, 0.9388, 0.938, 0.9365, 0.9178, 0.9106, 0.8996, 0.8982, 0.8849, 0.8831, 0.8813, 0.8759, 0.8686, 0.8664, 0.8628, 0.8624, 0.8579, 0.8561, 0.8548, 0.8404, 0.7692, 0.7727, 0.7454, 0.5947, 0.7511, 0.7846, 0.7304, 0.7587, 0.5291, 0.2082, 0.5503, 0.6113, 0.5837, 0.527, 0.1834, 0.423, 0.0107, 0.3756, 0.2296, 0.5595, -0.2599, 0.2673, 0.2222, 0.1486, 0.1211, 0.4042, 0.2895, 1.136, 1.0378, 1.0326, 1.0128, 1.011, 0.9979, 0.9965, 0.9878, 0.9829, 0.9742, 0.9486, 0.9415, 0.9075, 0.904, 0.8732, 0.8732, 0.8732, 0.8675, 0.8674, 0.8618, 0.8614, 0.8501, 0.8419, 0.8419, 0.8388, 0.8383, 0.836, 0.836, 0.836, 0.8356, 0.8269, 0.7751, 0.7575, 0.6237, 0.7706, 0.7833, 0.4944, 0.7704, 0.5278, 0.511, 0.5624, 0.4828, 0.7319, 0.5922, 0.7382, 0.5076, 0.5935, 0.4768, -0.0125, 0.4908, 0.202, -0.1735, 0.4494, 0.1901, 0.257, 0.3837, 0.0979, -0.158, 0.4951, 0.1646, 0.2088, 1.1182, 0.9804, 0.9212, 0.9167, 0.9, 0.9, 0.8957, 0.8957, 0.8929, 0.8908, 0.8908, 0.884, 0.854, 0.8514, 0.8514, 0.8482, 0.8458, 0.843, 0.8325, 0.8316, 0.8264, 0.8264, 0.8201, 0.8126, 0.8018, 0.8018, 0.8009, 0.795, 0.7891, 0.7808, 0.7586, 0.6508, 0.6454, 0.6642, 0.6753, 0.6372, 0.6984, 0.7499, 0.6551, 0.6541, 0.6762, 0.7519, 0.3846, 0.2804, 0.3053, 0.2928, 0.3886, 0.2108, 0.3578, 0.2808, 0.5806, 0.182, 0.5434, 0.1039, 0.3315, 0.2411, 0.0439, 0.3093, 0.1133, 0.3528, 0.075, -0.4903, -0.4766, 0.1524, 0.0736, -0.0483, -0.6193]}, "token.table": {"Topic": [1, 2, 3, 2, 4, 3, 1, 1, 2, 1, 2, 4, 1, 1, 2, 3, 2, 1, 1, 4, 1, 2, 1, 2, 1, 2, 3, 1], "Freq": [0.42451562947939253, 0.42451562947939253, 0.42451562947939253, 0.35551691787503537, 0.35551691787503537, 0.7436937529450655, 1.1113028858186276, 0.6873547268740873, 0.7128606001186852, 0.6715229269425774, 0.4281429965068635, 0.4281429965068635, 0.6921220614651777, 0.3354637933620378, 0.3354637933620378, 0.3354637933620378, 0.7982721889963206, 1.0343217779509801, 0.693279285739864, 0.7046143458961588, 0.9345522026371047, 0.8948318884732915, 0.9365004605622058, 0.7205869960486053, 0.34856016668212364, 0.34856016668212364, 0.34856016668212364, 0.778608438051073], "Term": ["bad", "bad", "bad", "chicken", "chicken", "closed", "coffee", "come", "drink", "friend", "good", "good", "horrible", "like", "like", "like", "meal", "mediocre", "minute", "sauce", "shop", "slow", "store", "table", "time", "time", "time", "wait"]}, "R": 30, "lambda.step": 0.01, "plot.opts": {"xlab": "PC1", "ylab": "PC2"}, "topic.order": [5, 4, 2, 3, 1]};

function LDAvis_load_lib(url, callback){
  var s = document.createElement('script');
  s.src = url;
  s.async = true;
  s.onreadystatechange = s.onload = callback;
  s.onerror = function(){console.warn("failed to load library " + url);};
  document.getElementsByTagName("head")[0].appendChild(s);
}

if(typeof(LDAvis) !== "undefined"){
   // already loaded: just create the visualization
   !function(LDAvis){
       new LDAvis("#" + "ldavis_el50902110807445446688751285", ldavis_el50902110807445446688751285_data);
   }(LDAvis);
}else if(typeof define === "function" && define.amd){
   // require.js is available: use it to load d3/LDAvis
   require.config({paths: {d3: "https://d3js.org/d3.v5"}});
   require(["d3"], function(d3){
      window.d3 = d3;
      LDAvis_load_lib("https://cdn.jsdelivr.net/gh/bmabey/pyLDAvis@3.4.0/pyLDAvis/js/ldavis.v3.0.0.js", function(){
        new LDAvis("#" + "ldavis_el50902110807445446688751285", ldavis_el50902110807445446688751285_data);
      });
    });
}else{
    // require.js not available: dynamically load d3 & LDAvis
    LDAvis_load_lib("https://d3js.org/d3.v5.js", function(){
         LDAvis_load_lib("https://cdn.jsdelivr.net/gh/bmabey/pyLDAvis@3.4.0/pyLDAvis/js/ldavis.v3.0.0.js", function(){
                 new LDAvis("#" + "ldavis_el50902110807445446688751285", ldavis_el50902110807445446688751285_data);
            })
         });
}
</script>
</div>
</div>
</section>
</section>
</section>
<section id="dimensionality-reduction-with-pca" class="level2">
<h2 class="anchored" data-anchor-id="dimensionality-reduction-with-pca">Dimensionality Reduction with PCA</h2>
<section id="positive-reviews-2" class="level3">
<h3 class="anchored" data-anchor-id="positive-reviews-2">Positive Reviews</h3>
<div id="d5ac0956" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.decomposition <span class="im">import</span> PCA</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply PCA to reduce to 2 components</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>pca <span class="op">=</span> PCA(n_components<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>pca_positive <span class="op">=</span> pca.fit_transform(positive_tfidf.toarray())</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the reduced data</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">7</span>))</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>plt.scatter(pca_positive[:, <span class="dv">0</span>], pca_positive[:, <span class="dv">1</span>], c<span class="op">=</span><span class="st">'blue'</span>, edgecolor<span class="op">=</span><span class="st">'k'</span>)</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'PCA of Positive Yelp Reviews'</span>)</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Principal Component 1'</span>)</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Principal Component 2'</span>)</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-47-output-1.png" width="825" height="603" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="negative-reviews-2" class="level3">
<h3 class="anchored" data-anchor-id="negative-reviews-2">Negative Reviews</h3>
<div id="664b88f8" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>pca_negative <span class="op">=</span> pca.fit_transform(negative_tfidf.toarray())</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the reduced data</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">7</span>))</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>plt.scatter(pca_negative[:, <span class="dv">0</span>], pca_negative[:, <span class="dv">1</span>], c<span class="op">=</span><span class="st">'blue'</span>, edgecolor<span class="op">=</span><span class="st">'k'</span>)</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'PCA of Positive Yelp Reviews'</span>)</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Principal Component 1'</span>)</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Principal Component 2'</span>)</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-48-output-1.png" width="825" height="603" class="figure-img"></p>
</figure>
</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>